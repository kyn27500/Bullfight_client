{"version":3,"sources":["../../../../../../assets/resources/Script/network/assets/resources/Script/network/RequestHandler.js"],"names":["onfire","require","scenes","texts","tools","RequestHandler","_serverConnect","sendRequest","actionName","data","_sock","readyState","console","error","showMessageDialog","hall","PROMPT","CONNECTION_LOST","cc","director","loadScene","LOGIN_SCENE","requestObj","messageCode","dataString","JSON","stringify","body","md5","requestString","log","send","module","exports"],"mappings":";;;;;;;;AAAA,IAAIA,SAASC,QAAQ,QAAR,CAAb,EAAgC;AAChC,IAAIC,SAASD,QAAQ,WAAR,CAAb;AACA,IAAIE,QAAQF,QAAQ,MAAR,CAAZ;AACA,IAAIG,QAAQH,QAAQ,OAAR,CAAZ;;AAEA,IAAII,iBAAiB;AACjBC,oBAAgBL,QAAQ,eAAR,CADC,EACyB;;AAE1CM,iBAAa,qBAASC,UAAT,EAAqBC,IAArB,EAA2B;AACpC,YAAI,KAAKH,cAAL,CAAoBI,KAApB,CAA0BC,UAA1B,KAAyC,CAA7C,EAAgD;AAC5C;AACAC,oBAAQC,KAAR,CAAc,oBAAd;AACAT,kBAAMU,iBAAN,CAAwBX,MAAMY,IAAN,CAAWC,MAAnC,EAA2Cb,MAAMY,IAAN,CAAWE,eAAtD;AACAC,eAAGC,QAAH,CAAYC,SAAZ,CAAsBlB,OAAOa,IAAP,CAAYM,WAAlC;AACA;AACH;AACD;AACA,YAAI,QAAOZ,IAAP,yCAAOA,IAAP,MAAgB,QAApB,EAA8B;AAC1B,gBAAIa,aAAa,EAAjB;AACAA,uBAAWC,WAAX,GAAyBf,UAAzB;AACA,gBAAIgB,aAAaC,KAAKC,SAAL,CAAejB,IAAf,CAAjB;AACAa,uBAAWK,IAAX,GAAkBH,UAAlB;AACAF,uBAAWM,GAAX,GAAiB,aAAjB;AACA,gBAAIC,gBAAgBJ,KAAKC,SAAL,CAAeJ,UAAf,CAApB;AACAV,oBAAQkB,GAAR,CAAY,4BAAZ,EAA0CD,aAA1C;AACA,iBAAKvB,cAAL,CAAoByB,IAApB,CAAyBF,aAAzB;AACH;AACJ;AAtBgB,CAArB;;AAyBAG,OAAOC,OAAP,GAAiB5B,cAAjB","file":"RequestHandler.js","sourceRoot":"../../../../../../assets/resources/Script/network","sourcesContent":["var onfire = require(\"onfire\"); //处理事件的类库\r\nvar scenes = require(\"SceneList\");\r\nvar texts = require(\"Text\");\r\nvar tools = require(\"Tools\");\r\n\r\nvar RequestHandler = {\r\n    _serverConnect: require('ServerConnect'), //当前的webSocket的对象\r\n\r\n    sendRequest: function(actionName, data) {\r\n        if (this._serverConnect._sock.readyState !== 1) {\r\n            // 应增加更多玩家提示，以及重连\r\n            console.error('sendRequest failed');\r\n            tools.showMessageDialog(texts.hall.PROMPT, texts.hall.CONNECTION_LOST);\r\n            cc.director.loadScene(scenes.hall.LOGIN_SCENE);\r\n            return;\r\n        }\r\n        // console.log('sendRequest:',actionName,typeof(data));\r\n        if (typeof(data) == 'object') {\r\n            var requestObj = {};\r\n            requestObj.messageCode = actionName;\r\n            var dataString = JSON.stringify(data);\r\n            requestObj.body = dataString;\r\n            requestObj.md5 = \"maybe later\";\r\n            var requestString = JSON.stringify(requestObj);\r\n            console.log('sendRequest requestString:', requestString);\r\n            this._serverConnect.send(requestString);\r\n        }\r\n    },\r\n};\r\n\r\nmodule.exports = RequestHandler;"]}
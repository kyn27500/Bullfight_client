{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\..\\assets\\resources\\Script\\view\\games\\doushouqi/assets\\resources\\Script\\view\\games\\doushouqi\\Animal.js"],"names":["Com","require","cc","Class","extends","Component","properties","node_obj","default","type","Sprite","sp_animal","sp_icon","sp_mask_bottom","breakAni","Animation","nodeBreak","Node","sp_self","sp_tip_break","is_big","is_break","row","col","animalIndex","animalColor","onLoad","init","node","active","opacity","_touchCallback","_breakCallback","_objCode","addTouchListener","event","customEventData","onPlayGameEffect","onRunSmall","start","update","dt","onSetAnimalInfo","animalInfo","playAnimation","animationCall","animalCode","animState","play","self","console","log","onSetAnimalCode","onFinished","onLoadAnimal","onPlayEffect","on","onShowAnimal","destroy","onRunBig","bigFinishCall","seq","sequence","moveTo","p","scaleTo","callFunc","runAction","smallFinishCall","onMoveToTarget","moveData","callback","moveFinishCall","scale","moveEnd","targetPos","x","y","getAnimalIsBig","getAnimalIsBreak","onSetLocalZorder","zorder","setLocalZOrder","index","bottomColor","isBlue","animalResIdx","bottomImgUrl","onGetBottomImg","onLoadAnimalRes","bottom","mask","urlAnimal","onGetAnimalUrl","urlIcon","onGetAnimalIconUrl","spriteFrame","onSetSelf","imgUrl","targetNode","loader","loadRes","SpriteFrame","error","getComponent","onSetRowAndCol","onGetRowAndCol","obj","onDestory","onGetAnimalCode","onGetSelfColor","onGetAnimalIndex","onSetTouchCallback","touchcallback","onBreakBombCallback","breakcallback","onGetComponentStr","onHideTip","onShowSelfTip","onOptionalObj"],"mappings":"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","file":"Animal.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\resources\\Script\\view\\games\\doushouqi","sourcesContent":["/**\r\n *  @brief: 小动物\r\n *  @time:  2018-05-5\r\n *  @author: JiangTao\r\n * \r\n *  点击后变大，在此点击后变回原来大小\r\n * \r\n *  @修改：服务器联调，点开箱子后，服务器才返回对应的动物。\r\n */\r\n\r\n\r\nvar Com = require('Com')\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        node_obj: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n        sp_animal: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n        sp_icon: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n\r\n        // 动物底座\r\n        sp_mask_bottom: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n\r\n        breakAni: {\r\n            default: null,\r\n            type: cc.Animation\r\n        },\r\n\r\n        nodeBreak: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        sp_self: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n\r\n        sp_tip_break: {\r\n            default: null,\r\n            type: cc.Sprite,\r\n        },\r\n\r\n        is_big: false,\r\n\r\n        is_break: false,\r\n\r\n        row:   -1,\r\n\r\n        col:   -1,\r\n\r\n        animalIndex: -1,\r\n\r\n        animalColor: \"\",    //  标记动物颜色，blue:蓝色动物 red：红色动物 默认是空的\r\n\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n\r\n        // this.init();\r\n\r\n    },\r\n\r\n    init: function () {\r\n\r\n        this.sp_self.node.active = false;\r\n\r\n        this.sp_tip_break.node.opacity = 0;\r\n\r\n        this.sp_tip_break.node.active = false;\r\n\r\n        this.sp_tip_break.node.opacity = 0;\r\n\r\n        this.is_big = false;    //当前是否被选中\r\n\r\n        this.is_break = false;\r\n\r\n        this._touchCallback = null;\r\n\r\n        this._breakCallback = null;\r\n\r\n        this._objCode       = -1;   //操作方的code 1:红方 2:蓝方 -1:还没有确定属于红蓝\r\n\r\n    },\r\n\r\n    // 监听点击事件\r\n    addTouchListener: function ( event, customEventData ) {\r\n\r\n        if ( customEventData == \"break\" ) {\r\n\r\n            Com.onPlayGameEffect( 0 );\r\n\r\n            if ( this._breakCallback ) {\r\n\r\n                this._breakCallback( this.row, this.col, \"Animal\" );\r\n\r\n            }\r\n\r\n        } else if ( customEventData == \"animal\" ) {\r\n\r\n            Com.onPlayGameEffect( 2 );\r\n\r\n            if ( this.is_big ) {\r\n\r\n                this.onRunSmall();\r\n            \r\n                if ( this._touchCallback ) {\r\n\r\n                    this._touchCallback( this.row, this.col, this._objCode, false );\r\n    \r\n                }\r\n\r\n            } else {\r\n\r\n                // this.onRunBig();\r\n\r\n                if ( this._touchCallback ) {\r\n\r\n                    this._touchCallback( this.row, this.col, this._objCode, true );\r\n    \r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n    },\r\n\r\n    start () {\r\n        // console.log(\" start +++++++++++++++++++++++++\")\r\n    },\r\n\r\n    update (dt) {\r\n        \r\n    },\r\n\r\n    onSetAnimalInfo: function ( animalInfo ) {\r\n\r\n        // 信息中包含 当前动物下标 根据下标找到对应的动物（判断出是红色还是蓝色）\r\n\r\n    },\r\n\r\n    // 播放爆开动画\r\n    playAnimation: function (  animationCall, animalIndex, animalCode ) {\r\n\r\n        var animState = this.breakAni.play('break');\r\n\r\n        var self = this;\r\n\r\n        console.log( \"playAnimation ====== \", animalCode );\r\n\r\n        this.onSetAnimalCode( animalCode )\r\n\r\n        function onFinished (  ) {\r\n\r\n            self.onLoadAnimal( animalIndex )\r\n\r\n            if ( animationCall ) {\r\n\r\n                animationCall( self.row, self.col );\r\n\r\n            }\r\n\r\n            Com.onPlayEffect( animalIndex );\r\n\r\n        };\r\n\r\n        animState.on('finished',  onFinished,  this.breakAni);\r\n\r\n    },\r\n\r\n    onShowAnimal: function (  ) {\r\n\r\n        this.is_break = true;\r\n\r\n        this.nodeBreak.destroy();\r\n\r\n        // 显示小动物\r\n        this.sp_animal.node.active = true;\r\n\r\n        this.sp_animal.node.opacity = 255;\r\n\r\n        this.sp_icon.node.active = true;\r\n\r\n        this.sp_icon.node.opacity = 255;\r\n\r\n        this.sp_mask_bottom.node.active = true;\r\n\r\n        this.sp_mask_bottom.node.opacity = 255;\r\n\r\n    },\r\n        \r\n    // 变大\r\n    onRunBig: function (   ) {\r\n\r\n        function bigFinishCall () {\r\n\r\n            this.is_big = true;\r\n\r\n        }\r\n\r\n        // cc.scaleTo(0.05, 1.1)\r\n\r\n        var seq =   cc.sequence(cc.moveTo(0.05, cc.p(0, 14)), \r\n                        cc.scaleTo(0.05, 1.1),\r\n                        cc.callFunc(bigFinishCall, this, this.node_obj));\r\n\r\n        this.node_obj.node.runAction(seq);\r\n\r\n    },\r\n\r\n    // 缩小\r\n    onRunSmall: function (   ) {\r\n\r\n        function smallFinishCall () {\r\n\r\n            this.is_big = false;\r\n\r\n        }\r\n\r\n        var seq =   cc.sequence(cc.moveTo(0.05, cc.p(0, 4)), \r\n                        cc.scaleTo(0.05, 1),\r\n                        cc.callFunc(smallFinishCall, this, this.node_obj));\r\n\r\n        this.node_obj.node.runAction(seq);\r\n\r\n    },\r\n\r\n    //移动位置\r\n    /**\r\n     * @brief: 移动\r\n     * @targetPos: 移动后的位置\r\n     * @row: 被吃掉棋子的横坐标\r\n     * @col：被吃的棋子的纵坐标\r\n     * @callback: 移动后的回调函数\r\n     * \r\n     * moveData = { targetPos:targetPos,    目标坐标位置\r\n     *              selectedRow:index0,     选择的行坐标\r\n     *              selectedCol:index1,     选择的列坐标\r\n     *              row:row,                目标行坐标\r\n     *              col:col,                目标列坐标\r\n     *              moveState:moveState     移动后的状态\r\n     *            };\r\n     */\r\n    onMoveToTarget: function ( moveData, callback ) {\r\n\r\n\r\n        var self = this;\r\n\r\n        function moveFinishCall () {\r\n\r\n            if ( callback ) {\r\n\r\n                callback( moveData );\r\n\r\n            }\r\n\r\n            self.is_big = false;\r\n\r\n            var scale = cc.scaleTo(0.05, 1);\r\n\r\n            self.node_obj.node.runAction( scale );\r\n\r\n        }\r\n\r\n        var moveEnd  = cc.moveTo(0.2, cc.p(moveData.targetPos.x, moveData.targetPos.y))\r\n\r\n        var seq =   cc.sequence(moveEnd,\r\n                                cc.callFunc(moveFinishCall, this, this.node));\r\n\r\n        this.node.runAction(seq);\r\n\r\n    },\r\n\r\n    // 获取当前对象是否变大了\r\n    getAnimalIsBig: function (  ) {\r\n\r\n        return this.is_big;\r\n\r\n    },\r\n\r\n    // 获取当前对象的箱子是否破裂\r\n    getAnimalIsBreak: function (  ) {\r\n\r\n        return this.is_break;\r\n\r\n    },\r\n\r\n    onSetLocalZorder: function ( zorder ) {\r\n\r\n        this.node.setLocalZOrder( zorder );\r\n\r\n    },\r\n\r\n    // 根据index变换资源 1-8\r\n    onLoadAnimal: function ( index ) {\r\n\r\n        // console.log(\" blue **************** \", index);\r\n        // 隐藏箱子\r\n\r\n        // 动物底座颜色\r\n        var bottomColor = \"blue\";\r\n\r\n        var isBlue      = false;\r\n\r\n        this.animalIndex = index;\r\n\r\n        var animalResIdx = index;\r\n\r\n        if ( index > 10 ) {\r\n\r\n            bottomColor = \"Animal_blue\";\r\n\r\n            animalResIdx = index - 10;\r\n\r\n            isBlue      = true;\r\n\r\n        } else {\r\n            \r\n            bottomColor = \"Animal_red\";\r\n\r\n            isBlue      = false;\r\n\r\n        }\r\n\r\n        // 动物底座颜色  动物下面的阴影\r\n        var bottomImgUrl = Com.onGetBottomImg( bottomColor );\r\n\r\n        this.onLoadAnimalRes( bottomImgUrl.bottom, this.node_obj );\r\n\r\n        this.onLoadAnimalRes( bottomImgUrl.mask, this.sp_mask_bottom );\r\n\r\n        var urlAnimal = Com.onGetAnimalUrl( animalResIdx );\r\n\r\n        var urlIcon = Com.onGetAnimalIconUrl( animalResIdx, isBlue );\r\n\r\n        // 动物头像\r\n        this.sp_animal.spriteFrame = urlAnimal;\r\n\r\n        // 动物名称\r\n        this.sp_icon.spriteFrame = urlIcon;\r\n\r\n        // 设置当前动物的颜色 蓝色 红色\r\n        this.onSetSelf( bottomColor );\r\n\r\n        this.onShowAnimal();\r\n\r\n    },\r\n\r\n    // \r\n    /**\r\n     * @brief: 动态更换动物图片\r\n     * @imgUrl: 动态加载图片\r\n     * @targetNode: 需要替换资源的对象\r\n     */\r\n    onLoadAnimalRes: function ( imgUrl, targetNode ) {\r\n\r\n        if ( !targetNode ) {\r\n\r\n            console.log( \" targetNode: \", targetNode );\r\n\r\n            return;\r\n        }\r\n\r\n        cc.loader.loadRes(imgUrl, cc.SpriteFrame, function (error, spriteFrame) {\r\n\r\n            if (!error) {\r\n\r\n                targetNode.getComponent(cc.Sprite).spriteFrame  = spriteFrame;\r\n\r\n            }\r\n\r\n        });\r\n\r\n    },\r\n\r\n    //  设置行 列坐标\r\n    onSetRowAndCol: function ( row, col ) {\r\n\r\n        this.row = row;\r\n\r\n        this.col = col;\r\n\r\n    },\r\n\r\n    // 获取行 列坐标\r\n    onGetRowAndCol: function (  ) {\r\n\r\n        var obj = {\r\n\r\n            \"row\": this.row,\r\n\r\n            \"col\": this.col,\r\n\r\n        };\r\n\r\n        return obj;\r\n\r\n    },\r\n\r\n    onDestory: function (  ) {\r\n\r\n        this.node.destroy();\r\n\r\n    },\r\n\r\n    onSetAnimalCode: function ( animalCode ) {\r\n\r\n        this._objCode  = animalCode;\r\n\r\n    },\r\n\r\n    onGetAnimalCode: function (  ) {\r\n\r\n        return this._objCode;\r\n\r\n    },\r\n\r\n    // 设置当前动物的颜色\r\n    onSetSelf: function ( animalColor ) {\r\n\r\n        this.animalColor = animalColor;\r\n\r\n    },\r\n\r\n    // 设置当前动物的颜色\r\n    onGetSelfColor: function (  ) {\r\n\r\n        return this.animalColor;\r\n\r\n    },\r\n\r\n    onGetAnimalIndex: function (  ) {\r\n\r\n        return this.animalIndex;\r\n\r\n    },\r\n\r\n    // 设置回调函数\r\n    onSetTouchCallback: function ( touchcallback ) {\r\n\r\n        this._touchCallback = touchcallback;\r\n\r\n    },\r\n\r\n    // 设置回调函数\r\n    onBreakBombCallback: function ( breakcallback ) {\r\n\r\n        this._breakCallback = breakcallback;\r\n\r\n    },\r\n\r\n    onGetComponentStr: function ( ) {\r\n\r\n        return this.animalColor;\r\n\r\n    },\r\n\r\n    // 箱子绿色框\r\n    onHideTip: function (  ) {\r\n\r\n        this.sp_tip_break.node.active = false;\r\n\r\n        this.sp_tip_break.node.opacity = 0;\r\n\r\n        this.sp_self.node.active = false;\r\n\r\n        this.sp_self.node.opacity = 0;\r\n\r\n    },\r\n\r\n    // 点开箱子后的动物框\r\n    onShowSelfTip: function (  ) {\r\n\r\n        this.sp_tip_break.node.active = false;\r\n\r\n        this.sp_tip_break.node.opacity = 0;\r\n\r\n        this.sp_self.node.active = true;\r\n\r\n        this.sp_self.node.opacity = 255;\r\n\r\n    },\r\n\r\n    /**\r\n     * 显示可以操作的对象\r\n     */\r\n    onOptionalObj: function (  ) {\r\n\r\n        if ( this.is_break ) {\r\n\r\n            this.sp_tip_break.node.active = false;\r\n\r\n            this.sp_tip_break.node.opacity = 0;\r\n\r\n            this.sp_self.node.active = true;\r\n\r\n            this.sp_self.node.opacity = 255;\r\n\r\n        } else {\r\n\r\n            this.sp_tip_break.node.active = true;\r\n\r\n            this.sp_tip_break.node.opacity = 255;\r\n\r\n            this.sp_self.node.active = false;\r\n\r\n            this.sp_self.node.opacity = 0;\r\n\r\n        }\r\n\r\n    },\r\n\r\n\r\n});\r\n\r\n"]}
{"version":3,"sources":["..\\..\\..\\..\\..\\..\\..\\..\\assets\\resources\\Script\\view\\games\\Tiaoyitiao/assets\\resources\\Script\\view\\games\\Tiaoyitiao\\Tiaoyitiao.js"],"names":["config","require","onfire","imgConfig","Tools","requestHandler","events","scenes","HallData","prefabHelper","consts","globalData","myUserInfo","otherUserInfo","m_debug","m_personHalfHeight","m_totalTime","m_isGameOver","m_maxUpdateCount","cc","Class","extends","Component","properties","resultHolder","Node","btnBack","Button","btnHelp","tableNode","spriteBg","myScoreLabel","Label","myNameLabel","myHead","Sprite","myGenderMale","myGenderFemale","otherScoreLabel","otherNameLabel","otherHead","otherGenderMale","otherGenderFemale","timeLabel","scoreLabel","spriteFrames","Array","myProgressId","otherProgressId","myPersonNode","otherPersonNode","myLastPos","otherLastPos","sound_tv","AudioSource","sound_beer","sound_combo1","sound_combo2","sound_combo3","sound_combo4","sound_combo5","sound_combo6","sound_combo7","sound_combo8","sound_fail","sound_fire","sound_jilu","sound_jumpdown","sound_jumpup","sound_limitPress","sound_pressing","sound_reborn","sound_water","sound_music","sound_xiaodeng","time","isMove","updateCount","isJumping","curJumpDistance","posList","maxJumpDistance","stepDistance","myTotalScore","myCurScore","myLastScore","otherTotalScore","extraScoreList","ndExitFrame","ndTutorial","ndHelpButton","onBackClicked","customEventData","active","onExitOK","exitGame","onExitCancel","data","appId","getCurGameInfo","token","sendRequest","game","C2S_EXIT_GAME","director","loadScene","hall","HALL","fire","HALL_DATA","rawData","onLoad","Math","floor","listenerList","GAME_DATA","onReceive_login","tiaoyitiao","S2C_START","onReceive_start","S2C_PLAY","onReceive_play","S2C_PROGRESS","onReceive_progress","S2C_GAMEOVER","onReceive_overGame","forEach","on","element","EventType","TOUCH_START","TOUCH_END","TOUCH_CANCEL","isNetwork","gameData","index","list","nodeId","random","length","direction","distance","initGame","startTime","Date","getTime","onDestroy","un","off","self","loadResDir","createNode","createPersonNode","moveNodeToCenter","registerTouchEvent","updateTotalScore","loadRemoteImage","icon","string","name","sex","gender","MALE","FEMALE","data1","data2","console","log","otherDistance","getJumpData","otherScore","resultData","topPortrait","leftPortrait","rightPortrait","leftName","rightName","leftGender","rightGender","result","youWin","createResultScreen","update","dt","curTime","stepTime","nNextId","callback","getChildByTag","nodeData","nodeInfo","toString","node1","sprite","addComponent","spriteFrame","img1","node2","img2","scale","setAnchorPoint","p","setPosition","pos","addChild","calcPostion","node2Pos","x","y","funcCreateShadow","params","shadow","img3","shadowPos","moveTo","cf_callback","callFunc","seq","sequence","runAction","node","label","opacity","getPosition","dis","dir","curPos","nextPos","midPos","mvToPos","began","event","removeChildByTag","anim_anya","createAnimationByName","touchPress","end","play","setMidPoint","runBoxEffect","isPress","interval","repeat","schedule","updateBoxScaleY","stop","unscheduleAllCallbacks","playAnimationSound","animationName","isSelf","animName","speed","repeatCount","trim","animation","Animation","frameCount","frames","frameName","originalSize","getOriginalSize","setRect","rect","width","height","clip","AnimationClip","createWithSpriteFrames","addClip","anim","Infinity","count","k","scaleY","scaleX","scaleTo","easing","easeIn","moveUp","moveBy","spawn1","spawn","scaleTo1","spawn2","reverse","rotate","rotateBy","gameDataIndex","nextData","curCenterPos","jumpPos","isAtCenter","abs","nextInfo","jumpResult","success","nextId","jumpEffect","calcScore","progressId","score","nJumpSuccess","startPos","endPos","persoNode","scaleTo2","easeOut","at","sp","ep","cp","bezier","bezierTo","spa","checkJumpSuccess","drawBezier","runAddScoreAction","funcShowMidPoint","anim_jumpCenter","pNode","removeFromParent","anim_jump","addExtraScore","runLostAction","effect","delay","delayTime","cf_addScore","animNode","effectPos","C2S_PLAY","nMyScore","nOtherScore","nTotalScore","nCurScore","show","hide","curProgressId","zOrder","getLocalZOrder","setLocalZOrder","moveDown","blink","cf_setIsJump","anim_jumpLose","controlPos","drawNode","draw","Graphics","clear","quadraticCurveTo","lineTo","info","centerPos","spaceY","distance1","spaceX","distance2","stroke"],"mappings":"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","file":"Tiaoyitiao.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\resources\\Script\\view\\games\\Tiaoyitiao","sourcesContent":["var config = require(\"config\");\r\nvar onfire = require(\"onfire\");\r\nvar imgConfig = require(\"tyt_ImgConfig\");\r\nvar Tools = require(\"Tools\");\r\nvar requestHandler = require(\"RequestHandler\");\r\nvar events = require(\"CustomEvents\");\r\nvar scenes = require(\"SceneList\");\r\nvar HallData = require(\"HallData\");\r\nvar prefabHelper = require(\"PrefabHelper\");\r\nvar consts = require(\"Constants\");\r\nvar globalData = require(\"Global\");\r\n\r\nvar myUserInfo = null;\r\nvar otherUserInfo = null;\r\n\r\nvar m_debug = false;\r\nvar m_personHalfHeight = 52;\r\nvar m_totalTime = 120;\r\nvar m_isGameOver = false;\r\n\r\n// 最大跳跃 计数\r\nvar m_maxUpdateCount = 50;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        resultHolder: cc.Node,\r\n        btnBack: cc.Button,\r\n        btnHelp: cc.Button,\r\n\r\n        // 桌子节点\r\n        tableNode: cc.Node,\r\n\r\n        // 背景节点，用于监听 按压事件\r\n        spriteBg: cc.Node,\r\n\r\n        // 我的分数、我的名字、我的头像\r\n        myScoreLabel: cc.Label,\r\n        myNameLabel: cc.Label,\r\n        myHead: cc.Sprite,\r\n        myGenderMale: cc.Node,\r\n        myGenderFemale: cc.Node,\r\n\r\n        // 对方分数、对方名字、对方头像\r\n        otherScoreLabel: cc.Label,\r\n        otherNameLabel: cc.Label,\r\n        otherHead: cc.Sprite,\r\n        otherGenderMale: cc.Node,\r\n        otherGenderFemale: cc.Node,\r\n\r\n        // 倒计时标签\r\n        timeLabel: cc.Label,\r\n\r\n        // 得分标签\r\n        scoreLabel: cc.Label,\r\n\r\n        spriteFrames: Array,\r\n        myProgressId: 0,\r\n        otherProgressId: 0,\r\n\r\n        // 我的小人节点\r\n        myPersonNode: null,\r\n\r\n        // 对方小人节点\r\n        otherPersonNode: null,\r\n\r\n        // 我的上次位置，失败时，恢复上次位置\r\n        myLastPos: null,\r\n\r\n        // 对方上次位置\r\n        otherLastPos: null,\r\n\r\n        // 音效文件：\r\n        sound_tv: cc.AudioSource,\r\n        sound_beer: cc.AudioSource,\r\n        sound_combo1: cc.AudioSource,\r\n        sound_combo2: cc.AudioSource,\r\n        sound_combo3: cc.AudioSource,\r\n        sound_combo4: cc.AudioSource,\r\n        sound_combo5: cc.AudioSource,\r\n        sound_combo6: cc.AudioSource,\r\n        sound_combo7: cc.AudioSource,\r\n        sound_combo8: cc.AudioSource,\r\n        sound_fail: cc.AudioSource,\r\n        sound_fire: cc.AudioSource,\r\n        sound_jilu: cc.AudioSource,\r\n        sound_jumpdown: cc.AudioSource,\r\n        sound_jumpup: cc.AudioSource,\r\n        sound_limitPress: cc.AudioSource,\r\n        sound_pressing: cc.AudioSource,\r\n        sound_reborn: cc.AudioSource,\r\n        sound_water: cc.AudioSource,\r\n        sound_music: cc.AudioSource,\r\n        sound_xiaodeng: cc.AudioSource,\r\n\r\n        // 倒计时\r\n        time: null,\r\n\r\n        //更新事件\r\n        isMove: false,\r\n        updateCount: null,\r\n\r\n        // 是否跳跃中\r\n        isJumping: null,\r\n\r\n        // 当前跳跃距离\r\n        curJumpDistance: null,\r\n\r\n        // 块坐标 列表\r\n        posList: null,\r\n\r\n        // 最远跳跃距离\r\n        maxJumpDistance: 0,\r\n\r\n        //平均每次跳跃距离  \r\n        stepDistance: 0,\r\n\r\n        // 总分数\r\n        myTotalScore: 0,\r\n\r\n        // 当前加分\r\n        myCurScore: 0,\r\n\r\n        // 上次分数\r\n        myLastScore: 0,\r\n\r\n        // 对方总分数\r\n        otherTotalScore: 0,\r\n\r\n        // 特殊图案加分列表\r\n        extraScoreList: null,\r\n\r\n        // 退出\r\n        ndExitFrame: cc.Node,\r\n\r\n        // 教程\r\n        ndTutorial: cc.Node,\r\n        ndHelpButton: cc.Node,\r\n    },\r\n\r\n    onBackClicked: function(customEventData) {\r\n        this.ndExitFrame.active = true;\r\n    },\r\n\r\n    onExitOK: function(customEventData) {\r\n        this.exitGame();\r\n    },\r\n\r\n    onExitCancel: function(customEventData) {\r\n        this.ndExitFrame.active = false;\r\n    },\r\n\r\n    // 退出游戏\r\n    exitGame: function() {\r\n        var data = {\r\n            appId: HallData.getCurGameInfo().appId,\r\n            token: globalData.myUserInfo.token,\r\n        };\r\n        requestHandler.sendRequest(events.game.C2S_EXIT_GAME, data);\r\n        cc.director.loadScene(scenes.hall.HALL, function() {\r\n            onfire.fire(events.hall.HALL_DATA, HallData.rawData);\r\n        });\r\n    },\r\n\r\n    onLoad() {\r\n\r\n        this.stepDistance = Math.floor(this.maxJumpDistance / m_maxUpdateCount);\r\n\r\n        // 网络监听列表\r\n        var listenerList = [\r\n            [events.game.GAME_DATA, this.onReceive_login, this],\r\n            [events.game.tiaoyitiao.S2C_START, this.onReceive_start, this],\r\n            [events.game.tiaoyitiao.S2C_PLAY, this.onReceive_play, this],\r\n            [events.game.tiaoyitiao.S2C_PROGRESS, this.onReceive_progress, this],\r\n            [events.game.tiaoyitiao.S2C_GAMEOVER, this.onReceive_overGame, this],\r\n        ]\r\n        listenerList.forEach(element => {\r\n            onfire.on(element[0], element[1], element[2]);\r\n        });\r\n\r\n        // 教程事件\r\n        this.ndHelpButton.on(cc.Node.EventType.TOUCH_START, function() {\r\n            this.ndTutorial.active = true;\r\n        }, this);\r\n        this.ndHelpButton.on(cc.Node.EventType.TOUCH_END, function() {\r\n            this.ndTutorial.active = false;\r\n        }, this);\r\n        this.ndHelpButton.on(cc.Node.EventType.TOUCH_CANCEL, function() {\r\n            this.ndTutorial.active = false;\r\n        }, this);\r\n\r\n        // 无网络状态\r\n        if (!config.isNetwork) {\r\n            // 默认单机测试数据\r\n            this.gameData = [];\r\n            for (let index = 0; index < 200; index++) {\r\n                if (index == 0) {\r\n                    // 第一个 随机数据\r\n                    var list = [1006, 1009, 1011, 1022, 1016, 1014];\r\n                    this.gameData[index] = {\r\n                        nodeId: list[Math.floor(Math.random() * 10 % list.length)],\r\n                        direction: Math.random() * 10 < 5 ? 1 : 2,\r\n                        distance: 350\r\n                    };\r\n                } else if (index < 30) {\r\n                    this.gameData[index] = {\r\n                        nodeId: 1000 + index + 1,\r\n                        direction: Math.random() * 10 < 5 ? 1 : 2,\r\n                        distance: 350\r\n                    };\r\n                    if (index == 1) {\r\n                        this.gameData[index].direction = 2;\r\n                    }\r\n                } else {\r\n                    this.gameData[index] = {\r\n                        nodeId: 1000 + Math.floor(Math.random() * 100 % 29 + 1),\r\n                        direction: Math.random() * 10 < 5 ? 1 : 2,\r\n                        distance: 350\r\n                    };\r\n                }\r\n\r\n            }\r\n            this.initGame();\r\n\r\n            // 获取时间戳\r\n            this.startTime = new Date().getTime();\r\n        }\r\n    },\r\n\r\n    // 销毁时调用\r\n    onDestroy() {\r\n        // 移除监听\r\n        var listenerList = [\r\n            [events.game.GAME_DATA, this.onReceive_login, this],\r\n            [events.game.tiaoyitiao.S2C_START, this.onReceive_start, this],\r\n            [events.game.tiaoyitiao.S2C_PLAY, this.onReceive_play, this],\r\n            [events.game.tiaoyitiao.S2C_PROGRESS, this.onReceive_progress, this],\r\n            [events.game.tiaoyitiao.S2C_GAMEOVER, this.onReceive_overGame, this],\r\n        ]\r\n        listenerList.forEach(element => {\r\n            onfire.un(element[0]);\r\n        });\r\n        this.ndHelpButton.off(cc.Node.EventType.TOUCH_START);\r\n        this.ndHelpButton.off(cc.Node.EventType.TOUCH_END);\r\n        this.ndHelpButton.off(cc.Node.EventType.TOUCH_CANCEL);\r\n    },\r\n\r\n    // 初始化游戏\r\n    initGame() {\r\n\r\n        this.time = 0;\r\n        var self = this;\r\n        this.posList = [];\r\n        m_isGameOver = false;\r\n\r\n        // 加载 文件夹资源\r\n        Tools.loadResDir(\"games/tiaoyitiao\", function(spriteFrames) {\r\n            self.spriteFrames = spriteFrames;\r\n            //创建两个块\r\n            self.createNode(0);\r\n            self.createNode(1);\r\n            // 创建人物\r\n            self.createPersonNode();\r\n            // 移动到中心点\r\n            self.moveNodeToCenter(1);\r\n        });\r\n\r\n        // 注册监听\r\n        this.registerTouchEvent();\r\n        // 初始化分数\r\n        this.updateTotalScore(this.myTotalScore, this.otherTotalScore);\r\n\r\n        // 头像\r\n        Tools.loadRemoteImage(myUserInfo.icon, this.myHead);\r\n        Tools.loadRemoteImage(otherUserInfo.icon, this.otherHead);\r\n\r\n        // 名称\r\n        this.myNameLabel.string = myUserInfo.name;\r\n        this.otherNameLabel.string = otherUserInfo.name;\r\n\r\n        // 性别\r\n        this.myGenderMale.active = (myUserInfo.sex == consts.gender.MALE);\r\n        this.myGenderFemale.active = (myUserInfo.sex == consts.gender.FEMALE);\r\n        this.otherGenderMale.active = (otherUserInfo.sex == consts.gender.MALE);\r\n        this.otherGenderFemale.active = (otherUserInfo.sex == consts.gender.FEMALE);\r\n    },\r\n\r\n    // 网络回调：登录数据\r\n    onReceive_login(data1, data2) {\r\n        console.log(data1);\r\n        this.gameData = data1.gameData;\r\n        myUserInfo = data1.myUserInfo;\r\n        otherUserInfo = data1.otherUserInfo;\r\n        this.initGame();\r\n    },\r\n\r\n    // 网络回调：游戏开始\r\n    onReceive_start(data1, data2) {\r\n        // 获取时间戳\r\n        this.startTime = new Date().getTime();\r\n    },\r\n\r\n    // 网络回调：游戏过程\r\n    onReceive_play(data1, data2) {\r\n\r\n    },\r\n\r\n    // 网络回调：对方数据\r\n    onReceive_progress(data1, data2) {\r\n\r\n        if (data1.otherDistance > 0) {\r\n            this.getJumpData(data1.otherDistance, data1.otherProgressId, false);\r\n        }\r\n        // 设置总分数\r\n        this.updateTotalScore(null, data1.otherScore);\r\n    },\r\n\r\n    // 网络回调：游戏结束\r\n    onReceive_overGame(data1, data2) {\r\n        console.log(\"-------- s_tiaoYiTiao_overGame ------  \");\r\n        console.log(data1);\r\n        m_isGameOver = true;\r\n        var resultData = {};\r\n        if (!config.isNetwork) {\r\n            resultData.topPortrait = \"http://zyhdheads.oss-cn-beijing.aliyuncs.com/default1.png\";\r\n            resultData.leftPortrait = \"http://zyhdheads.oss-cn-beijing.aliyuncs.com/default1.png\";\r\n            resultData.rightPortrait = \"http://zyhdheads.oss-cn-beijing.aliyuncs.com/default1.png\";\r\n            resultData.leftName = \"左边的玩家\";\r\n            resultData.rightName = \"右边的玩家\";\r\n            resultData.leftGender = 1; // 左边性别 0:男 1:女\r\n            resultData.rightGender = 0; // 右边性别 0:男 1:女\r\n            resultData.result = 1; // 结果 1:胜利 0:平局 -1:失败\r\n            resultData.appId = 2; // 游戏id\r\n        } else {\r\n            resultData.topPortrait = myUserInfo.icon;\r\n            resultData.leftPortrait = myUserInfo.icon;\r\n            resultData.rightPortrait = otherUserInfo.icon;\r\n            resultData.leftName = myUserInfo.name;\r\n            resultData.rightName = otherUserInfo.name;\r\n            resultData.leftGender = myUserInfo.sex;\r\n            resultData.rightGender = otherUserInfo.sex;\r\n            resultData.result = data1.youWin;\r\n            resultData.appId = HallData.getCurGameInfo().appId;\r\n        }\r\n        prefabHelper.createResultScreen(this.resultHolder, resultData);\r\n    },\r\n\r\n    // 更新\r\n    update(dt) {\r\n        // 更新时间\r\n        if (this.startTime) {\r\n            var curTime = new Date().getTime();\r\n            var stepTime = Math.floor((curTime - this.startTime) / 1000);\r\n            if (m_totalTime - stepTime < 0) {\r\n                console.log(\"游戏结束！\");\r\n                this.startTime = 0;\r\n            } else {\r\n                this.timeLabel.string = (m_totalTime - stepTime);\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    //创建块\r\n    createNode(nNextId, callback) {\r\n\r\n        if (this.tableNode.getChildByTag(nNextId)) {\r\n            if (callback) {\r\n                callback();\r\n            };\r\n            return;\r\n        }\r\n        var self = this;\r\n        var nodeData = this.gameData[nNextId];\r\n        var nodeInfo = imgConfig[nodeData.nodeId.toString()];\r\n\r\n        var node1 = new cc.Node();\r\n        var sprite = node1.addComponent(cc.Sprite);\r\n        sprite.spriteFrame = this.spriteFrames[nodeInfo.img1];\r\n\r\n        var node2 = new cc.Node();\r\n        var sprite = node2.addComponent(cc.Sprite);\r\n        sprite.spriteFrame = this.spriteFrames[nodeInfo.img2];\r\n        node2.scale = nodeInfo.scale;\r\n\r\n        // 设置锚点，添加节点\r\n        node2.setAnchorPoint(cc.p(0.5, 0));\r\n        node1.setPosition(nodeInfo.pos);\r\n\r\n        node2.addChild(node1, 0, 1001);\r\n        this.tableNode.addChild(node2, 1, nNextId);\r\n\r\n        // 计算节点\r\n        var pos = this.calcPostion(nNextId);\r\n        var node2Pos = cc.p(pos.x - nodeInfo.pos.x * nodeInfo.scale, pos.y - nodeInfo.pos.y * nodeInfo.scale);\r\n        node2.setPosition(node2Pos);\r\n\r\n        // 创建阴影\r\n        var funcCreateShadow = function(params) {\r\n            var shadow = new cc.Node();\r\n            var sprite = shadow.addComponent(cc.Sprite);\r\n            sprite.spriteFrame = self.spriteFrames[nodeInfo.img3];\r\n            shadow.setPosition(nodeInfo.shadowPos);\r\n            node2.addChild(shadow, -10, 1003);\r\n        }\r\n\r\n        // 动画 从上落下\r\n        if (nNextId > 1) {\r\n            node2.setPosition(node2Pos.x, node2Pos.y + 100);\r\n            var moveTo = cc.moveTo(0.3, node2Pos);\r\n            var cf_callback = cc.callFunc(function() {\r\n                if (callback) {\r\n                    funcCreateShadow();\r\n                    callback();\r\n                };\r\n            });\r\n            var seq = cc.sequence(moveTo, cf_callback);\r\n            node2.runAction(seq);\r\n        } else {\r\n            funcCreateShadow()\r\n        }\r\n\r\n        // 调试模式\r\n        if (m_debug) {\r\n            var node = new cc.Node();\r\n            var label = node.addComponent(cc.Label);\r\n            label.string = nNextId + \",\" + nodeData.nodeId;\r\n            node.x = pos.x - 100;\r\n            node.y = pos.y + 100;\r\n            this.tableNode.addChild(node);\r\n        }\r\n    },\r\n\r\n    //创建小人\r\n    createPersonNode() {\r\n        // 对方小人\r\n        this.otherPersonNode = new cc.Node();\r\n        this.otherPersonNode.opacity = 120;\r\n        var sprite = this.otherPersonNode.addComponent(cc.Sprite);\r\n        sprite.spriteFrame = this.spriteFrames[\"xiaoren_blue\"];\r\n        this.otherPersonNode.setPosition(this.posList[0].x - 33, this.posList[0].y + 66);\r\n        this.tableNode.addChild(this.otherPersonNode, 3);\r\n        // 我的小人\r\n        this.myPersonNode = new cc.Node();\r\n        var sprite = this.myPersonNode.addComponent(cc.Sprite);\r\n        sprite.spriteFrame = this.spriteFrames[\"xiaoren_red\"];\r\n        this.myPersonNode.setPosition(this.posList[0].x + 39, this.posList[0].y + 25);\r\n        this.tableNode.addChild(this.myPersonNode, 4);\r\n        // 获取起点位置\r\n        this.myLastPos = this.myPersonNode.getPosition();\r\n        this.myLastPos.y = this.myLastPos.y - m_personHalfHeight;\r\n        this.otherLastPos = this.otherPersonNode.getPosition();\r\n        this.otherLastPos.y = this.otherLastPos.y - m_personHalfHeight;\r\n    },\r\n\r\n    // 计算坐标\r\n    calcPostion(nNextId) {\r\n        if (nNextId == 0) {\r\n            this.posList[0] = cc.p(300, 210);\r\n            return this.posList[0];\r\n        } else {\r\n            var dis = this.gameData[nNextId].distance;\r\n            var dir = this.gameData[nNextId].direction;\r\n            var y = Math.floor(dis / 2);\r\n            var x = Math.floor(dis / 2 * 1.73);\r\n            var curPos = this.posList[nNextId - 1];\r\n            var nextPos = cc.p(curPos.x + (dir == 2 ? 1 : -1) * x, curPos.y + y);\r\n            this.posList[nNextId] = nextPos;\r\n            return nextPos;\r\n        }\r\n    },\r\n\r\n    // 移动到中点\r\n    moveNodeToCenter(nNextId) {\r\n        var pos = cc.p(320, 350);\r\n        var curPos = this.posList[nNextId - 1];\r\n        var nextPos = this.posList[nNextId];\r\n        var midPos = cc.p((curPos.x + nextPos.x) / 2, (curPos.y + nextPos.y) / 2);\r\n        var mvToPos = cc.p(pos.x - midPos.x, pos.y - midPos.y);\r\n\r\n        var moveTo = cc.moveTo(0.5, mvToPos);\r\n        this.tableNode.runAction(moveTo);\r\n    },\r\n\r\n    // 注册监听\r\n    registerTouchEvent() {\r\n        var began = function(event) {\r\n            if (m_isGameOver) return;\r\n            console.log(\"-----------   began   ------------\");\r\n            if (this.isJumping) {\r\n                return\r\n            }\r\n            this.updateCount = 0;\r\n            this.isMove = true;\r\n\r\n            // 清理额外加分节点 2s\r\n            this.tableNode.removeChildByTag(2002)\r\n\r\n            // 按压效果\r\n            var anim_anya = this.createAnimationByName(\"anya\", 1, 99)\r\n            anim_anya.setPosition(20, -10);\r\n            this.myPersonNode.addChild(anim_anya, 0, 101);\r\n            this.touchPress(true);\r\n        };\r\n\r\n        var end = function(event) {\r\n            if (m_isGameOver) return;\r\n            console.log(\"-----------   end   ------------\", this.updateCount);\r\n            if (this.isJumping) {\r\n                return\r\n            }\r\n            // 起跳音效\r\n            this.sound_jumpup.play();\r\n\r\n            this.isJumping = true;\r\n            this.isMove = false;\r\n            this.touchPress(false);\r\n            this.setMidPoint();\r\n            // 清理蓄力 效果\r\n            this.myPersonNode.removeChildByTag(101);\r\n            this.runBoxEffect();\r\n            var distance = this.stepDistance * this.updateCount;\r\n            this.getJumpData(distance, this.myProgressId + 1, true);\r\n        }\r\n        this.spriteBg.on(cc.Node.EventType.TOUCH_START, began, this);\r\n        this.spriteBg.on(cc.Node.EventType.TOUCH_END, end, this);\r\n    },\r\n\r\n    // 按压调整\r\n    touchPress(isPress) {\r\n\r\n        // 按压\r\n        if (isPress) {\r\n            // 以秒为单位的时间间隔\r\n            var interval = 0.02;\r\n            // 重复次数\r\n            var repeat = m_maxUpdateCount;\r\n            // 开始延时\r\n\r\n            var self = this;\r\n            this.btnBack.schedule(function() {\r\n                self.updateCount = self.updateCount + 1;\r\n                self.updateBoxScaleY(self.updateCount);\r\n                if (self.updateCount == m_maxUpdateCount) {\r\n                    self.sound_limitPress.play();\r\n                }\r\n            }, interval, repeat, 0);\r\n        } else {\r\n            this.sound_limitPress.stop();\r\n            this.btnBack.unscheduleAllCallbacks();\r\n        }\r\n    },\r\n\r\n    // 播放动画音效\r\n    playAnimationSound(animationName, isSelf) {\r\n        if (animationName == \"dianshi\") {\r\n            this.sound_tv.play();\r\n        } else if (animationName == \"anya\") {\r\n            this.sound_pressing.play();\r\n        } else if (animationName == \"luodi\") {\r\n            this.sound_jumpdown.play();\r\n        } else if (animationName == \"luoshui\" && isSelf) {\r\n            this.sound_fail.play();\r\n        } else if (animationName == \"maoyan\") {\r\n            this.sound_fire.play();\r\n        } else if (animationName == \"pijiupao\") {\r\n            this.sound_beer.play();\r\n        } else if (animationName == \"shuilifang\") {\r\n            this.sound_water.play();\r\n        } else if (animationName == \"xiaodeng\") {\r\n            this.sound_xiaodeng.play();\r\n        } else if (animationName == \"zhongxindian\") {\r\n            if (this.myCurScore == 2) {\r\n                this.sound_combo1.play();\r\n            } else if (this.myCurScore == 4) {\r\n                this.sound_combo2.play();\r\n            } else if (this.myCurScore == 6) {\r\n                this.sound_combo3.play();\r\n            } else if (this.myCurScore == 8) {\r\n                this.sound_combo4.play();\r\n            } else if (this.myCurScore == 10) {\r\n                this.sound_combo5.play();\r\n            } else if (this.myCurScore == 12) {\r\n                this.sound_combo6.play();\r\n            } else if (this.myCurScore == 14) {\r\n                this.sound_combo7.play();\r\n            } else if (this.myCurScore >= 16) {\r\n                this.sound_combo8.play();\r\n            }\r\n        } else if (animationName == \"yinyue\") {\r\n            this.sound_music.play();\r\n        }\r\n    },\r\n\r\n    //创建帧动画\r\n    createAnimationByName(animName, speed, repeatCount, callback, isSelf) {\r\n\r\n        this.playAnimationSound(animName, isSelf);\r\n\r\n        var node = new cc.Node(animName);\r\n        var sprite = node.addComponent(cc.Sprite);\r\n        sprite.trim = false;\r\n\r\n        var animation = node.addComponent(cc.Animation);\r\n\r\n        // 注册\r\n        animation.on('finished', function() {\r\n            if (callback) {\r\n                callback(node);\r\n            }\r\n        }, this);\r\n\r\n        var frameCount = 0\r\n        var frames = [];\r\n        for (let index = 0; index < 99; index++) {\r\n            var frameName = animName + \"_\" + (index + 1);\r\n            if (this.spriteFrames[frameName]) {\r\n                frameCount = frameCount + 1;\r\n\r\n                frames[index] = this.spriteFrames[frameName];\r\n                var originalSize = frames[index].getOriginalSize()\r\n                frames[index].setRect(cc.rect(0, 0, originalSize.width, originalSize.height));\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        var clip = cc.AnimationClip.createWithSpriteFrames(frames, frameCount);\r\n        clip.name = \"run\";\r\n        animation.addClip(clip);\r\n        var anim = animation.play('run');\r\n        anim.speed = speed || 6;\r\n        if (repeatCount == 99) {\r\n            anim.repeatCount = Infinity;\r\n        } else {\r\n            anim.repeatCount = repeatCount;\r\n        }\r\n        return node\r\n    },\r\n\r\n    // 箱子压缩\r\n    updateBoxScaleY(count) {\r\n        if (count <= m_maxUpdateCount) {\r\n            var k = 200;\r\n            var node = this.tableNode.getChildByTag(this.myProgressId);\r\n            node.scaleY = node.scaleX - count / k;\r\n            // 人物缩小，并下移\r\n            this.myPersonNode.scaleY = this.myPersonNode.scaleX - count / k;\r\n            this.myPersonNode.y = this.myLastPos.y + m_personHalfHeight - this.tableNode.getChildByTag(this.myProgressId).height * count / k;\r\n        }\r\n    },\r\n\r\n    // 发射弹力箱子\r\n    runBoxEffect() {\r\n        var node = this.tableNode.getChildByTag(this.myProgressId);\r\n\r\n        var scaleTo = cc.scaleTo(0.03, node.scaleX, node.scaleX + 0.04);\r\n        scaleTo.easing(cc.easeIn(3.0));\r\n        var moveUp = cc.moveBy(0.1, cc.p(0, 5));\r\n\r\n        var spawn1 = cc.spawn(scaleTo, moveUp);\r\n\r\n        var scaleTo1 = cc.scaleTo(0.03, node.scaleX);\r\n        var spawn2 = cc.spawn(moveUp.reverse(), scaleTo1);\r\n\r\n        var rotate = cc.rotateBy(0.1, 1);\r\n        var seq = cc.sequence(spawn1, spawn2);\r\n        node.runAction(seq);\r\n    },\r\n\r\n    // 计算跳跃数据\r\n    getJumpData(distance, gameDataIndex, isSelf) {\r\n\r\n        var nextData = this.gameData[gameDataIndex];\r\n        console.log(\"计算距离：\", distance, nextData.distance);\r\n        //计算上个中心点位置 （TODO 目前使用上个块的中心点， 实际应计算人物位置，因为第一个点人物站位不在 标准线上）\r\n        // var topNode = this.tableNode.getChildByTag(this.myProgressId).getChildByTag(1001);\r\n        // var curCenterPos = topNode.convertToWorldSpace(cc.p(topNode.width/2,topNode.height/2));\r\n        // curCenterPos = this.tableNode.convertToNodeSpace(curCenterPos);\r\n\r\n        var curCenterPos = this.posList[gameDataIndex - 1];\r\n\r\n        var jumpPos;\r\n        var isAtCenter;\r\n\r\n        // 默认 中心点 前后两个点，也让他跳中，提高中心点 命中率\r\n        if (Math.abs(distance - nextData.distance) <= this.stepDistance * 2) {\r\n            jumpPos = this.posList[gameDataIndex];\r\n            isAtCenter = true;\r\n        } else {\r\n            isAtCenter = false;\r\n\r\n            // 计算终点位置\r\n            var y = Math.floor(distance / 2);\r\n            var x = Math.floor(distance / 2 * 1.73);\r\n            jumpPos = cc.p(curCenterPos.x + (nextData.direction == 1 ? -x : x), curCenterPos.y + y);\r\n        }\r\n\r\n        //\r\n\r\n        // 判断是否 跳在台子上\r\n        var nextInfo = imgConfig[nextData.nodeId.toString()];\r\n        var jumpResult;\r\n        if (Math.abs(distance - nextData.distance) * 2 < nextInfo[\"distance\" + nextData.direction] * nextInfo.scale) {\r\n            jumpResult = {\r\n                success: 0,\r\n                nextId: gameDataIndex, //这里是下一个，也可能跳过一个，到第三个上面\r\n            }\r\n        } else {\r\n            //  检查再下个 是否\r\n            jumpResult = {\r\n                success: 1,\r\n                nextId: gameDataIndex, //这里是下一个，也可能跳过一个，到第三个上面,       //这里是下一个，也可能跳过一个，到第三个上面\r\n            }\r\n        }\r\n        // 跳跃效果\r\n        this.jumpEffect(isSelf ? this.myLastPos : this.otherLastPos, jumpPos, isSelf, nextData.direction, jumpResult);\r\n\r\n        // 是否是自己\r\n        if (isSelf) {\r\n            // 计算分数\r\n            this.calcScore(jumpResult.success, isAtCenter);\r\n\r\n            // 同步数据给另个玩家\r\n            if (config.isNetwork) {\r\n\r\n                var data = {\r\n                    progressId: gameDataIndex,\r\n                    score: this.myCurScore,\r\n                    distance: distance,\r\n                }\r\n                requestHandler.sendRequest(\"c_tiaoYiTiao_play\", data);\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    // 计算分数\r\n    calcScore(nJumpSuccess, isAtCenter) {\r\n\r\n        if (nJumpSuccess == 0) {\r\n            if (isAtCenter) {\r\n                if (this.myLastScore < 2) {\r\n                    this.myCurScore = 2;\r\n                } else {\r\n                    this.myCurScore = this.myLastScore + 2;\r\n                }\r\n            } else {\r\n                this.myCurScore = 1;\r\n            }\r\n            this.myLastScore = this.myCurScore;\r\n            this.myTotalScore = this.myTotalScore + this.myCurScore;\r\n        } else {\r\n            this.myCurScore = 0;\r\n            this.myLastScore = 0;\r\n        }\r\n    },\r\n\r\n    // 跳跃\r\n    jumpEffect(startPos, endPos, isSelf, direction, jumpResult) {\r\n        var persoNode = isSelf == true ? this.myPersonNode : this.otherPersonNode;\r\n        persoNode.setPosition(startPos);\r\n\r\n        //弹出时，小人伸展\r\n        var scaleTo1 = cc.scaleTo(0.1, 1, 1.2);\r\n        var scaleTo2 = cc.scaleTo(0.1, 1);\r\n        var seq = cc.sequence(scaleTo1, scaleTo2);\r\n        seq.easing(cc.easeOut(1.5));\r\n        persoNode.runAction(seq);\r\n\r\n        // 贝塞尔曲线跳跃\r\n        var at = 0.4\r\n        var sp = cc.p(startPos.x, startPos.y + m_personHalfHeight);\r\n        var ep = cc.p(endPos.x, endPos.y + m_personHalfHeight);\r\n        var cp = cc.p((sp.x + ep.x) / 2, sp.y + 600);\r\n        var bezier = [sp, cp, ep];\r\n        var bezierTo = cc.bezierTo(at, bezier);\r\n        var rotate = cc.rotateBy(at, direction == 2 ? 360 : -360);\r\n        var spa = cc.spawn(bezierTo, rotate);\r\n        spa.easing(cc.easeOut(1.5));\r\n        // 设置回调\r\n        var self = this;\r\n        var cf_callback = cc.callFunc(function() {\r\n\r\n            self.checkJumpSuccess(endPos, isSelf, jumpResult);\r\n        });\r\n        var seq = cc.sequence(spa, cf_callback);\r\n        persoNode.runAction(seq);\r\n\r\n        // 画线 测试使用\r\n        if (m_debug) {\r\n            this.drawBezier(startPos, endPos, cp);\r\n        }\r\n\r\n    },\r\n\r\n    // 计算跳跃,是否成功\r\n    checkJumpSuccess(endPos, isSelf, jumpResult) {\r\n\r\n        console.log(\"----- checkJumpSuccess:\", jumpResult);\r\n        // 跳成功\r\n        if (jumpResult.success == 0) {\r\n            if (isSelf) {\r\n                this.myLastPos = endPos;\r\n                this.isJumping = false;\r\n                this.myProgressId = jumpResult.nextId;\r\n                this.runAddScoreAction(this.myTotalScore, this.myCurScore);\r\n\r\n                // 显示白点\r\n                var self = this;\r\n                var funcShowMidPoint = function() {\r\n                    // 中心点\r\n                    if (self.myCurScore >= 2) {\r\n                        self.setMidPoint(self.myProgressId + 1);\r\n                        // 跳中心点效果\r\n                        var anim_jumpCenter = self.createAnimationByName(\"zhongxindian\", 2, 1, function(pNode) {\r\n                            pNode.removeFromParent();\r\n                        })\r\n                        anim_jumpCenter.setPosition(endPos);\r\n                        self.tableNode.addChild(anim_jumpCenter, 1, 102);\r\n                    } else {\r\n                        // 跳中心点效果\r\n                        var anim_jump = self.createAnimationByName(\"luodi\", 2, 1, function(pNode) {\r\n                            pNode.removeFromParent();\r\n                        })\r\n                        anim_jump.setPosition(endPos);\r\n                        self.tableNode.addChild(anim_jump, 1, 103);\r\n                    }\r\n                };\r\n                this.createNode(jumpResult.nextId + 1, funcShowMidPoint);\r\n                this.moveNodeToCenter(this.myProgressId + 1);\r\n\r\n                this.addExtraScore();\r\n\r\n            } else {\r\n                this.createNode(jumpResult.nextId + 1);\r\n                this.otherLastPos = endPos;\r\n                this.otherProgressId = jumpResult.nextId;\r\n            }\r\n        } else {\r\n            this.setMidPoint();\r\n            // 失败，恢复原位\r\n            this.runLostAction(isSelf, endPos);\r\n        }\r\n    },\r\n\r\n    // 等待2s 特殊图案加分\r\n    addExtraScore() {\r\n        // 检测是否是 特殊图案，停留可加分\r\n        var nodeInfo = imgConfig[this.gameData[this.myProgressId].nodeId.toString()]\r\n        if (nodeInfo.effect) {\r\n            var node = new cc.Node();\r\n            var delay = cc.delayTime(2);\r\n            var self = this;\r\n            var cf_addScore = cc.callFunc(function() {\r\n                self.myTotalScore = self.myTotalScore + nodeInfo.score;\r\n                self.runAddScoreAction(self.myTotalScore, nodeInfo.score)\r\n\r\n                var animNode = self.createAnimationByName(nodeInfo.effect, 1, 1, function(pNode) {\r\n                    pNode.removeFromParent();\r\n                });\r\n                animNode.setPosition(nodeInfo.effectPos);\r\n                self.tableNode.getChildByTag(self.myProgressId).addChild(animNode);\r\n\r\n                // TODO 发送网络 加分\r\n                var data = {\r\n                    progressId: self.myProgressId,\r\n                    score: nodeInfo.score,\r\n                    distance: 0,\r\n                }\r\n                requestHandler.sendRequest(events.game.tiaoyitiao.C2S_PLAY, data);\r\n\r\n            });\r\n            var seq = cc.sequence(delay, cf_addScore);\r\n            node.runAction(seq);\r\n            this.tableNode.addChild(node, 0, 2002)\r\n        }\r\n    },\r\n\r\n    // 设置分数\r\n    updateTotalScore(nMyScore, nOtherScore) {\r\n        if (nMyScore) {\r\n            this.myScoreLabel.string = nMyScore;\r\n        };\r\n        if (nOtherScore) {\r\n            this.otherScoreLabel.string = nOtherScore;\r\n        };\r\n    },\r\n\r\n    // 加分数\r\n    runAddScoreAction(nTotalScore, nCurScore) {\r\n\r\n        this.updateTotalScore(nTotalScore);\r\n\r\n        this.scoreLabel.node.active = true;\r\n        this.scoreLabel.string = \"+\" + nCurScore;\r\n\r\n        this.scoreLabel.node.x = this.myPersonNode.x - 50;\r\n        this.scoreLabel.node.y = this.myPersonNode.y + 100;\r\n\r\n        var moveUp = cc.moveBy(0.4, cc.p(0, 50));\r\n        var seq = cc.sequence(cc.show(), moveUp, cc.hide());\r\n        this.scoreLabel.node.runAction(seq);\r\n\r\n    },\r\n\r\n    // 失败动画\r\n    runLostAction(isSelf, endPos) {\r\n\r\n        var node = isSelf ? this.myPersonNode : this.otherPersonNode;\r\n        var curProgressId = isSelf ? this.myProgressId : this.otherProgressId;\r\n        var zOrder = node.getLocalZOrder();\r\n\r\n        // 检测跳跃终点在 块的后面\r\n        if (endPos.y > this.posList[curProgressId + 1].y || endPos.y < (this.posList[curProgressId].y + this.posList[curProgressId + 1].y) / 2) {\r\n            node.setLocalZOrder(0);\r\n        }\r\n\r\n        var moveDown = cc.moveBy(0.2, cc.p(0, -80));\r\n        var self = this;\r\n\r\n        var cf_callback = cc.callFunc(function() {\r\n            if (isSelf) {\r\n                node.setPosition(self.myLastPos.x, self.myLastPos.y + m_personHalfHeight);\r\n            } else {\r\n                node.setPosition(self.otherLastPos.x, self.otherLastPos.y + m_personHalfHeight);\r\n            }\r\n            node.setLocalZOrder(zOrder);\r\n\r\n            var blink = cc.blink(0.3, 2);\r\n            var cf_setIsJump = cc.callFunc(function() {\r\n                self.isJumping = false;\r\n            });\r\n            var seq = cc.sequence(blink, cf_setIsJump);\r\n            node.runAction(seq);\r\n        });\r\n        var delay = cc.delayTime(0.3);\r\n        var seq = cc.sequence(moveDown, delay, cc.delayTime(0.1), cf_callback);\r\n        node.runAction(seq);\r\n\r\n        // 落水动画\r\n        var anim_jumpLose = this.createAnimationByName(\"luoshui\", 2, 1, function(pNode) {\r\n            pNode.removeFromParent();\r\n        }, isSelf)\r\n        anim_jumpLose.setPosition(endPos);\r\n        this.tableNode.addChild(anim_jumpLose, 0, 104);\r\n    },\r\n\r\n    // 创建白点\r\n    setMidPoint(index) {\r\n\r\n        if (index) {\r\n            var node = new cc.Node();\r\n            var sprite = node.addComponent(cc.Sprite);\r\n            sprite.spriteFrame = this.spriteFrames[\"zhongxindian\"];\r\n            node.setPosition(this.posList[index]);\r\n            this.tableNode.addChild(node, 1, 2001);\r\n\r\n        } else {\r\n            if (this.tableNode.getChildByTag(2001)) {\r\n                this.tableNode.removeChildByTag(2001);\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    // 画线\r\n    drawBezier(startPos, endPos, controlPos) {\r\n        if (!this.drawNode) {\r\n            this.drawNode = new cc.Node();\r\n            this.tableNode.addChild(this.drawNode, 2);\r\n            this.draw = this.drawNode.addComponent(cc.Graphics);\r\n        }\r\n        this.draw.clear();\r\n        this.draw.moveTo(startPos.x, startPos.y);\r\n        this.draw.quadraticCurveTo(controlPos.x, controlPos.y, endPos.x, endPos.y);\r\n\r\n        this.draw.moveTo(startPos.x, startPos.y);\r\n        this.draw.lineTo(endPos.x, endPos.y);\r\n\r\n        // 画距离\r\n        var info = imgConfig[this.gameData[this.myProgressId + 1].nodeId]\r\n        var centerPos = this.posList[this.myProgressId + 1];\r\n\r\n        // 计算distance1 \r\n        var spaceY = info.distance1 / 4 * info.scale;\r\n        var spaceX = Math.floor(spaceY * 1.73);\r\n        this.draw.moveTo(centerPos.x - spaceX, centerPos.y + spaceY);\r\n        this.draw.lineTo(centerPos.x + spaceX, centerPos.y - spaceY);\r\n\r\n\r\n        // 计算distance2\r\n        var spaceY = info.distance2 / 4 * info.scale;\r\n        var spaceX = Math.floor(spaceY * 1.73);\r\n        this.draw.moveTo(centerPos.x - spaceX, centerPos.y - spaceY);\r\n        this.draw.lineTo(centerPos.x + spaceX, centerPos.y + spaceY);\r\n\r\n        this.draw.stroke();\r\n    },\r\n\r\n});"]}
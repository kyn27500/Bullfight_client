{"version":3,"sources":["../../../../../../assets/resources/Script/view/assets/resources/Script/view/Hall.js"],"names":["self","serverConnect","require","requestHandler","onfire","events","GameData","cc","Class","extends","Component","properties","labelNotice","Label","labelName","labelPlayerId","labelScore","btnRoom_niuniu","Button","btnJoinRoom","onLoad","connect","on","OPEN","onServerConnectOpen","ERROR","onServerConnectError","start","onDestroy","obj","console","log","JSON","stringify","un","hall","S2C_LOGIN","data1","data2","setUserInfo","userInfo","data","loginId","sendRequest","C2S_LOGIN","joinRoom","onResourceLoaded","errorMessage","loadedResource","Prefab","gamePrefab","instantiate","node","addChild","loader","loadRes","string","name","uid","score"],"mappings":";;;;;;AACA,IAAIA,IAAJ;AACA,IAAIC,gBAAgBC,QAAQ,eAAR,CAApB;AACA,IAAIC,iBAAiBD,QAAQ,gBAAR,CAArB;AACA,IAAIE,SAASF,QAAQ,QAAR,CAAb;AACA,IAAIG,SAASH,QAAQ,cAAR,CAAb;AACA,IAAII,WAAWJ,QAAQ,UAAR,CAAf;;AAEAK,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;;AAERC,qBAAaL,GAAGM,KAFR;AAGRC,mBAAWP,GAAGM,KAHN;AAIRE,uBAAeR,GAAGM,KAJV;AAKRG,oBAAYT,GAAGM,KALP;;AAORI,wBAAgBV,GAAGW,MAPX;AAQRC,qBAAaZ,GAAGW;AARR,KAHP;;AAcL;AACAE,YAAQ,kBAAY;AAChBpB,eAAO,IAAP;;AAEAC,sBAAcoB,OAAd,CAAsB,IAAtB;AACAjB,eAAOkB,EAAP,CAAUjB,OAAOD,MAAP,CAAcmB,IAAxB,EAA8B,KAAKC,mBAAnC;AACApB,eAAOkB,EAAP,CAAUjB,OAAOD,MAAP,CAAcqB,KAAxB,EAA+B,KAAKC,oBAApC;AACH,KArBI;;AAuBL;AACA;;AAEA;AACAC,SA3BK,mBA2BG;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACH,KApCI;AAsCLC,aAtCK,uBAsCO,CAEX,CAxCI;;;AA0CLF,0BAAsB,8BAASG,GAAT,EAAc;AAChCC,gBAAQC,GAAR,CAAYC,KAAKC,SAAL,CAAeJ,GAAf,CAAZ;AACH,KA5CI;;AA8CLL,yBAAqB,+BAAW;AAC5BM,gBAAQC,GAAR,CAAY,kBAAZ;AACA3B,eAAO8B,EAAP,CAAU7B,OAAOD,MAAP,CAAcmB,IAAxB;;AAEAnB,eAAOkB,EAAP,CAAUjB,OAAO8B,IAAP,CAAYC,SAAtB,EAAiC,UAASC,KAAT,EAAgBC,KAAhB,EAAuB;AACpDR,oBAAQC,GAAR,CAAY,mBAAZ,EAAiCM,KAAjC;AACA/B,qBAASiC,WAAT,CAAqBF,MAAMG,QAA3B;AACAxC,iBAAKuC,WAAL,CAAiBF,MAAMG,QAAvB;AACApC,mBAAO8B,EAAP,CAAU7B,OAAO8B,IAAP,CAAYC,SAAtB;AACH,SALD;;AAOA,YAAIK,OAAO;AACPC,qBAAQ;AADD,SAAX;AAGAvC,uBAAewC,WAAf,CAA2BtC,OAAO8B,IAAP,CAAYS,SAAvC,EAAkDH,IAAlD;AACH,KA7DI;;AA+DLI,YA/DK,sBA+DM;AACP,YAAIC,mBAAmB,SAAnBA,gBAAmB,CAASC,YAAT,EAAuBC,cAAvB,EAAuC;AAC1D;AACA,gBAAID,YAAJ,EAAkB;AACdxC,mBAAGwB,GAAH,CAAO,cAAcgB,YAArB;AACA;AACH;AACD,gBAAI,EAAEC,0BAA0BzC,GAAG0C,MAA/B,CAAJ,EAA4C;AACxC1C,mBAAGwB,GAAH,CAAO,OAAP;AACA;AACH,aATyD,CASxD;;AAEF;AACA,gBAAImB,aAAa3C,GAAG4C,WAAH,CAAeH,cAAf,CAAjB;AACAhD,iBAAKoD,IAAL,CAAUC,QAAV,CAAmBH,UAAnB;AAEH,SAfD;AAgBA;AACA3C,WAAG+C,MAAH,CAAUC,OAAV,CAAkB,kBAAlB,EAAsCT,gBAAtC;AACH,KAlFI;;;AAoFL;;;;AAIAP,eAxFK,uBAwFOE,IAxFP,EAwFa;AACdzC,aAAKc,SAAL,CAAe0C,MAAf,GAAwBf,KAAKgB,IAA7B;AACAzD,aAAKe,aAAL,CAAmByC,MAAnB,GAA4Bf,KAAKiB,GAAjC;AACA;AACA1D,aAAKgB,UAAL,CAAgBwC,MAAhB,GAAyBf,KAAKkB,KAA9B;AACH;AA7FI,CAAT","file":"Hall.js","sourceRoot":"../../../../../../assets/resources/Script/view","sourcesContent":["\nvar self;\nvar serverConnect = require(\"ServerConnect\");\nvar requestHandler = require(\"RequestHandler\");\nvar onfire = require(\"onfire\");\nvar events = require(\"CustomEvents\");\nvar GameData = require(\"GameData\")\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        labelNotice: cc.Label,\n        labelName: cc.Label,\n        labelPlayerId: cc.Label,\n        labelScore: cc.Label,\n\n        btnRoom_niuniu: cc.Button,\n        btnJoinRoom: cc.Button,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        self = this;\n\n        serverConnect.connect(true);\n        onfire.on(events.onfire.OPEN, this.onServerConnectOpen);\n        onfire.on(events.onfire.ERROR, this.onServerConnectError);\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n    start() {\n\n        // var data = {\n        //     name: \"唱山歌\",\n        //     playerId: 123,\n        //     notice: \"我是公告！\",\n        //     score: 23422,\n        // }\n        // self.setUserInfo(data)\n    },\n\n    onDestroy() {\n\n    },\n\n    onServerConnectError: function(obj) {\n        console.log(JSON.stringify(obj));\n    },\n\n    onServerConnectOpen: function() {\n        console.log(\"server connected\");\n        onfire.un(events.onfire.OPEN);\n\n        onfire.on(events.hall.S2C_LOGIN, function(data1, data2) {\n            console.log(\"s_game_login=====\", data1);\n            GameData.setUserInfo(data1.userInfo);\n            self.setUserInfo(data1.userInfo)\n            onfire.un(events.hall.S2C_LOGIN);\n        });\n\n        var data = {\n            loginId:123\n        };\n        requestHandler.sendRequest(events.hall.C2S_LOGIN, data);\n    },\n\n    joinRoom() {\n        var onResourceLoaded = function(errorMessage, loadedResource) {\n            //检查失败原因\n            if (errorMessage) {\n                cc.log('加载失败, 原因:' + errorMessage);\n                return;\n            }\n            if (!(loadedResource instanceof cc.Prefab)) {\n                cc.log('类型不对！');\n                return;\n            } //這個是型別的檢查\n\n            //接著，我們就可以進行實例化了\n            var gamePrefab = cc.instantiate(loadedResource);\n            self.node.addChild(gamePrefab);\n            \n        };\n        //這邊才是真的使用cc.loader進行載入，並且呼叫我們上面寫的方法\n        cc.loader.loadRes(\"Prefab/join_room\", onResourceLoaded);\n    },\n\n    /**\n     * 设置用户信息\n     * @param {*} data \n     */\n    setUserInfo(data) {\n        self.labelName.string = data.name;\n        self.labelPlayerId.string = data.uid;\n        // self.labelNotice.string = data.notice;\n        self.labelScore.string = data.score;\n    }\n});\n"]}
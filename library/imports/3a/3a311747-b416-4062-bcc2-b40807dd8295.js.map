{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\resources\\Script\\view/assets\\resources\\Script\\view\\Game.js"],"names":["self","requestHandler","require","onfire","events","GameData","cc","Class","extends","Component","properties","playerNode","Node","seatNode","btnReady","bankerNode","betNode","operation","centerNode","myPlayer","buttonTest","sf_tableAtlas","SpriteAtlas","spStateLabel","Sprite","clockNode","clockLabel","Label","onLoad","userInfo","getUserInfo","roomCode","getRoomCode","initWidget","listenerList","hall","HALL_DATA","onReceive_login","game","S2C_SEAT_CHOOSE","onReceive_sitDown","S2C_SYN_SEATS","onReceive_syn_seat","S2C_READY","onReceive_Ready","S2C_CARDS","onReceive_cards","S2C_GAME_STATE","onReceive_gameState","S2C_ROB_BANKER","onReceive_robBanker","S2C_BET","onReceive_bet","S2C_ROOM_BANKER","onReceive_roomBanker","S2C_LAST_CARD","onReceive_lastCard","S2C_OPEN_CARD","onReceive_openCard","forEach","on","element","players","seats","index","getChildByName","getComponent","myPlayerObj","active","data","console","log","un","sitDown","event","seatId","seatInfo","ready","Number","mySeatId","sitUp","roomNo","sendRequest","C2S_SEAT_CHOOSE","seatPlayers","list","seatIndex","indexOf","splice","uid","user","id","node","create","state","setBetNum","robBankerBet","banker","bet","sendReady","C2S_READY","result","sendCardAction","playerCards","currentGameNum","bankerIndex","myLastCardData","setReady","resetPlayer","setGameState","onClickForBanker","multiple","betPointQuantity","C2S_ROB_BANKER","onClickForBet","C2S_BET","setBanker","onClickForOpenCard","C2S_OPEN_CARD","setScore","showResultScore","score","playerCard","cardType","openLastCard","playerCardsSort","lastCard","niuType","sortedCards","cards","spriteFrame","_spriteFrames","runClock","nTotalSecond","stopAllActions","string","cf_func","callFunc","delay","delayTime","seq","sequence","rep","repeat","runAction","onClickButtonTest","C2S_RESET_GAMESTATE"],"mappings":";;;;;;AAAA,IAAIA,IAAJ;AACA,IAAIC,iBAAiBC,QAAQ,gBAAR,CAArB;AACA,IAAIC,SAASD,QAAQ,QAAR,CAAb;AACA,IAAIE,SAASF,QAAQ,cAAR,CAAb;AACA,IAAIG,WAAWH,QAAQ,UAAR,CAAf;AACAI,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAYL,GAAGM,IADP;AAERC,kBAAUP,GAAGM,IAFL;AAGRE,kBAAUR,GAAGM,IAHL;AAIRG,oBAAYT,GAAGM,IAJP;AAKRI,iBAASV,GAAGM,IALJ;AAMRK,mBAAWX,GAAGM,IANN;AAORM,oBAAYZ,GAAGM,IAPP,EAOoB;AAC5BO,kBAAUb,GAAGM,IARL,EAQoB;AAC5BQ,oBAAYd,GAAGM,IATP;;AAWRS,uBAAef,GAAGgB,WAXV,EAWuB;;AAE/BC,sBAAcjB,GAAGkB,MAbT,EAaoB;AAC5BC,mBAAWnB,GAAGM,IAdN,EAcqB;AAC7Bc,oBAAYpB,GAAGqB,KAfP,CAeqB;;;AAfrB,KAHP;;AAwBL;AACAC,YAAQ,kBAAY;;AAEhB5B,eAAO,IAAP;AACAA,aAAK6B,QAAL,GAAgBxB,SAASyB,WAAT,EAAhB;AACA9B,aAAK+B,QAAL,GAAgB1B,SAAS2B,WAAT,EAAhB;AACA;AACAhC,aAAKiC,UAAL;AACA;AACA,YAAIC,eAAe,CACf,CAAC9B,OAAO+B,IAAP,CAAYC,SAAb,EAAwB,KAAKC,eAA7B,EAA8C,IAA9C,CADe,EAEf,CAACjC,OAAOkC,IAAP,CAAYC,eAAb,EAA8B,KAAKC,iBAAnC,EAAsD,IAAtD,CAFe,EAGf,CAACpC,OAAOkC,IAAP,CAAYG,aAAb,EAA4B,KAAKC,kBAAjC,EAAqD,IAArD,CAHe,EAIf,CAACtC,OAAOkC,IAAP,CAAYK,SAAb,EAAwB,KAAKC,eAA7B,EAA8C,IAA9C,CAJe,EAKf,CAACxC,OAAOkC,IAAP,CAAYO,SAAb,EAAwB,KAAKC,eAA7B,EAA8C,IAA9C,CALe,EAMf,CAAC1C,OAAOkC,IAAP,CAAYS,cAAb,EAA6B,KAAKC,mBAAlC,EAAuD,IAAvD,CANe,EAOf,CAAC5C,OAAOkC,IAAP,CAAYW,cAAb,EAA6B,KAAKC,mBAAlC,EAAuD,IAAvD,CAPe,EAQf,CAAC9C,OAAOkC,IAAP,CAAYa,OAAb,EAAsB,KAAKC,aAA3B,EAA0C,IAA1C,CARe,EASf,CAAChD,OAAOkC,IAAP,CAAYe,eAAb,EAA8B,KAAKC,oBAAnC,EAAyD,IAAzD,CATe,EAUf,CAAClD,OAAOkC,IAAP,CAAYiB,aAAb,EAA4B,KAAKC,kBAAjC,EAAqD,IAArD,CAVe,EAWf,CAACpD,OAAOkC,IAAP,CAAYmB,aAAb,EAA4B,KAAKC,kBAAjC,EAAqD,IAArD,CAXe,CAAnB;AAiBAxB,qBAAayB,OAAb,CAAqB,mBAAW;AAC5BxD,mBAAOyD,EAAP,CAAUC,QAAQ,CAAR,CAAV,EAAsBA,QAAQ,CAAR,CAAtB,EAAkCA,QAAQ,CAAR,CAAlC;AACH,SAFD;AAIH,KAtDI;;AAwDL;;;AAGA5B,cA3DK,wBA2DQ;AACT;AACAjC,aAAK8D,OAAL,GAAe,EAAf;AACA;AACA9D,aAAK+D,KAAL,GAAa,EAAb;AACA,aAAK,IAAIC,QAAQ,CAAjB,EAAoBA,QAAQ,EAA5B,EAAgCA,OAAhC,EAAyC;AACrC;AACAhE,iBAAK8D,OAAL,CAAaE,KAAb,IAAsBhE,KAAKW,UAAL,CAAgBsD,cAAhB,CAA+B,WAAWD,KAA1C,EAAiDE,YAAjD,CAA8D,QAA9D,CAAtB;AACA;AACAlE,iBAAK+D,KAAL,CAAWC,KAAX,IAAoBhE,KAAKa,QAAL,CAAcoD,cAAd,CAA6B,SAASD,KAAtC,CAApB;AACH;AACDhE,aAAKmE,WAAL,GAAmBnE,KAAKmB,QAAL,CAAc+C,YAAd,CAA2B,QAA3B,CAAnB;AACAlE,aAAKc,QAAL,CAAcsD,MAAd,GAAuB,KAAvB;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AAEH,KApFI;;;AAsFL;;;;AAIA/B,mBA1FK,2BA0FWgC,IA1FX,EA0FiB;AAClBC,gBAAQC,GAAR,CAAY,YAAZ,EAA0BF,IAA1B;AACArE,aAAK6B,QAAL,GAAgBwC,KAAKxC,QAArB;AACA1B,eAAOqE,EAAP,CAAUpE,OAAO+B,IAAP,CAAYC,SAAtB;AACH,KA9FI;;AA+FL;;;;AAIAqC,WAnGK,mBAmGGC,KAnGH,EAmGUC,MAnGV,EAmGkB;;AAEnB,YAAI3E,KAAK4E,QAAL,IAAiB,CAAC5E,KAAK4E,QAAL,CAAcC,KAApC,EAA2C;AACvC;AACH;AACDF,iBAASG,OAAOH,MAAP,CAAT;AACA,YAAI3E,KAAK+E,QAAT,EAAmB;AACf;AACA/E,iBAAK8D,OAAL,CAAa9D,KAAK+E,QAAlB,EAA4BC,KAA5B;AACH;;AAEDhF,aAAK+E,QAAL,GAAgBJ,MAAhB;AACAL,gBAAQC,GAAR,CAAY,OAAZ,EAAqBI,MAArB;AACA,YAAIN,OAAO;AACPY,oBAAQjF,KAAK+B,QADN;AAEP4C,oBAAQA;AAFD,SAAX;AAIA1E,uBAAeiF,WAAf,CAA2B9E,OAAOkC,IAAP,CAAY6C,eAAvC,EAAwDd,IAAxD;AACH,KArHI;;;AAuHL;;;;AAIA7B,qBA3HK,6BA2Ha6B,IA3Hb,EA2HmB;AACpB;AACA;AACAC,gBAAQC,GAAR,CAAY,OAAZ,EAAqBF,IAArB;AACH,KA/HI;;;AAiIL;;;;AAIA3B,sBArIK,8BAqIc2B,IArId,EAqIoB;AACrBC,gBAAQC,GAAR,CAAY,WAAZ,EAAyBF,IAAzB;AACArE,aAAKoF,WAAL,GAAmBf,KAAKe,WAAxB;AACA,YAAIC,OAAO,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,EAAa,CAAb,EAAgB,CAAhB,EAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,EAA4B,EAA5B,EAAgC,EAAhC,EAAoC,EAApC,CAAX;AACAhB,aAAKe,WAAL,CAAiBzB,OAAjB,CAAyB,mBAAW;AAChC;AACA,gBAAIgB,SAASd,QAAQyB,SAArB;;AAEA;AACA,gBAAGtF,KAAK+E,QAAR,EAAiB;AACb/E,qBAAK+D,KAAL,CAAW/D,KAAK+E,QAAhB,EAA0BX,MAA1B,GAAmC,KAAnC;AACH;;AAED,gBAAIJ,QAAQqB,KAAKE,OAAL,CAAaZ,MAAb,CAAZ;AACAU,iBAAKG,MAAL,CAAYxB,KAAZ,EAAmB,CAAnB;;AAEA;AACA,gBAAIhE,KAAK6B,QAAL,CAAc4D,GAAd,IAAqB5B,QAAQ6B,IAAR,CAAaC,EAAtC,EAA0C;AACtC3F,qBAAK4E,QAAL,GAAgBf,OAAhB;AACA7D,qBAAKc,QAAL,CAAcsD,MAAd,GAAuB,CAACP,QAAQgB,KAAhC;;AAEA,oBAAI,CAAC7E,KAAKmE,WAAL,CAAiByB,IAAjB,CAAsBxB,MAA3B,EAAmC;AAC/BpE,yBAAK8D,OAAL,CAAaa,MAAb,EAAqBkB,MAArB,CAA4BhC,OAA5B;AACH,iBAFD,MAGK,IAAI7D,KAAK8F,KAAL,IAAc,CAAlB,EAAqB;AACtB9F,yBAAKmE,WAAL,CAAiB4B,SAAjB,CAA2BlC,QAAQmC,YAAnC;AACH,iBAFI,MAGA,IAAIhG,KAAK8F,KAAL,IAAc,CAAd,IAAoB,CAACjC,QAAQoC,MAAjC,EAA0C;AAC3CjG,yBAAKmE,WAAL,CAAiB4B,SAAjB,CAA2BlC,QAAQqC,GAAnC;AACH,iBAFI,MAGA,IAAIlG,KAAK8F,KAAL,IAAc,CAAlB,EAAqB;AACtB9F,yBAAKmE,WAAL,CAAiB4B,SAAjB,CAA2B,CAA3B;AACH;AAGJ,aAlBD,MAkBO;AACH,oBAAI,CAAC/F,KAAK8D,OAAL,CAAaa,MAAb,EAAqBiB,IAArB,CAA0BxB,MAA/B,EAAuC;AACnCpE,yBAAK8D,OAAL,CAAaa,MAAb,EAAqBkB,MAArB,CAA4BhC,OAA5B;AACH,iBAFD,MAGK,IAAI7D,KAAK8F,KAAL,IAAc,CAAlB,EAAqB;AACtB9F,yBAAK8D,OAAL,CAAaa,MAAb,EAAqBoB,SAArB,CAA+BlC,QAAQmC,YAAvC;AACH,iBAFI,MAGA,IAAIhG,KAAK8F,KAAL,IAAc,CAAd,IAAoB,CAACjC,QAAQoC,MAAjC,EAA0C;AAC3CjG,yBAAK8D,OAAL,CAAaa,MAAb,EAAqBoB,SAArB,CAA+BlC,QAAQqC,GAAvC;AACH,iBAFI,MAGA,IAAIlG,KAAK8F,KAAL,IAAc,CAAlB,EAAqB;AACtB9F,yBAAK8D,OAAL,CAAaa,MAAb,EAAqBoB,SAArB,CAA+B,CAA/B;AACH;AAEJ;AACJ,SA9CD;;AAgDA;AACAV,aAAK1B,OAAL,CAAa,mBAAW;AACpB3D,iBAAK+D,KAAL,CAAWF,OAAX,EAAoBO,MAApB,GAA6B,IAA7B;AACH,SAFD;AAKH,KA/LI;AAiML+B,aAjMK,uBAiMO;AACR,YAAI9B,OAAO;AACPY,oBAAQjF,KAAK+B,QADN;AAEP4C,oBAAQ3E,KAAK+E;AAFN,SAAX;AAIA9E,uBAAeiF,WAAf,CAA2B9E,OAAOkC,IAAP,CAAY8D,SAAvC,EAAkD/B,IAAlD;AACH,KAvMI;;;AAyML;;;;AAIAzB,mBA7MK,2BA6MWyB,IA7MX,EA6MiB;AAClB,YAAIA,KAAKgC,MAAL,IAAe,CAAnB,EAAsB;AAClBrG,iBAAKmE,WAAL,CAAiB0B,MAAjB,CAAwB7F,KAAK4E,QAA7B;AACA5E,iBAAK8D,OAAL,CAAa9D,KAAK+E,QAAlB,EAA4BC,KAA5B;AACH;AACJ,KAlNI;;;AAoNL;;;;AAIAlC,mBAxNK,2BAwNWuB,IAxNX,EAwNiB;AAAA;;AAClBC,gBAAQC,GAAR,CAAY,QAAZ,EAAsBF,IAAtB;;AAEArE,aAAKoF,WAAL,CAAiBzB,OAAjB,CAAyB,mBAAW;AAChC,gBAAI3D,KAAK6B,QAAL,CAAc4D,GAAd,IAAqB5B,QAAQ6B,IAAR,CAAaC,EAAtC,EAA0C;AACtC3F,qBAAKmE,WAAL,CAAiBmC,cAAjB,CAAgC,MAAKpF,UAArC,EAAiDmD,KAAKkC,WAAtD;AAEH,aAHD,MAGO;AACHvG,qBAAK8D,OAAL,CAAaD,QAAQyB,SAArB,EAAgCgB,cAAhC,CAA+C,MAAKpF,UAApD;AACH;AAEJ,SARD;AASH,KApOI;;;AAsOL;;;;AAIA8B,uBA1OK,+BA0OeqB,IA1Of,EA0OqB;AACtBC,gBAAQC,GAAR,CAAY,OAAZ,EAAqBF,KAAKyB,KAA1B,EAAiCzB,KAAKmC,cAAtC;;AAEA;AACAxG,aAAK8F,KAAL,GAAazB,KAAKyB,KAAlB;;AAEA;AACA9F,aAAKa,QAAL,CAAcuD,MAAd,GAAuBpE,KAAK8F,KAAL,IAAc,CAAd,IAAmB9F,KAAK8F,KAAL,IAAc,CAAxD;AACA;AACA9F,aAAKe,UAAL,CAAgBqD,MAAhB,GAAyBpE,KAAK8F,KAAL,IAAc,CAAvC;AACA;AACA9F,aAAKgB,OAAL,CAAaoD,MAAb,GAAsBpE,KAAK8F,KAAL,IAAc,CAAd,IAAmB9F,KAAKyG,WAAL,IAAoBzG,KAAK+E,QAAlE;AACA;AACA/E,aAAKiB,SAAL,CAAemD,MAAf,GAAwBpE,KAAK8F,KAAL,IAAc,CAAtC;AACA;AACA,YAAIzB,KAAKyB,KAAL,IAAc,CAAlB,EAAqB;;AAEjB;AACH,SAHD,MAGO,IAAIzB,KAAKyB,KAAL,IAAc,CAAlB,EAAqB;AACxB9F,iBAAK0G,cAAL,GAAsB,IAAtB;;AAEA;AACA1G,iBAAK8D,OAAL,CAAaH,OAAb,CAAqB,mBAAW;AAC5BE,wBAAQ8C,QAAR,CAAiB,KAAjB;AACH,aAFD;AAGA;AACH,SARM,MAQA,IAAItC,KAAKyB,KAAL,IAAc,CAAlB,EAAqB;;AAExB;AACH,SAHM,MAGA,IAAIzB,KAAKyB,KAAL,IAAc,CAAlB,EAAqB;AACxBxB,oBAAQC,GAAR,CAAY,gBAAZ,EAA8BvE,KAAK4E,QAAL,CAAcqB,MAA5C,EAAoDjG,KAAK8F,KAAL,IAAc,CAAd,IAAoB,CAAC9F,KAAK4E,QAAL,CAAcqB,MAAvF;AACA;AACH,SAHM,MAGA,IAAI5B,KAAKyB,KAAL,IAAc,CAAlB,EAAqB;;AAExB;AACH,SAHM,MAGA,IAAIzB,KAAKyB,KAAL,IAAc,CAAlB,EAAqB;;AAExB;AACH,SAHM,MAGA,IAAIzB,KAAKyB,KAAL,IAAc,CAAlB,EAAqB;;AAExB9F,iBAAK8D,OAAL,CAAaH,OAAb,CAAqB,mBAAW;AAC5BE,wBAAQ+C,WAAR;AACH,aAFD;AAGH;;AAED5G,aAAK6G,YAAL,CAAkB7G,KAAK8F,KAAvB;AACH,KAxRI;;;AA2RL;;;;;AAKAgB,oBAhSK,4BAgSYpC,KAhSZ,EAgSmBqC,QAhSnB,EAgS6B;AAC9B,YAAI1C,OAAO;AACPY,oBAAQjF,KAAK+B,QADN;AAEP4C,oBAAQ3E,KAAK+E,QAFN;AAGPiC,8BAAkBlC,OAAOiC,QAAP;AAHX,SAAX;AAKA9G,uBAAeiF,WAAf,CAA2B9E,OAAOkC,IAAP,CAAY2E,cAAvC,EAAuD5C,IAAvD;AACH,KAvSI;;;AAySL;;;;AAIAnB,uBA7SK,+BA6SemB,IA7Sf,EA6SqB;AACtBC,gBAAQC,GAAR,CAAY,OAAZ,EAAqBF,IAArB;AACArE,aAAKe,UAAL,CAAgBqD,MAAhB,GAAyB,KAAzB;AACH,KAhTI;;;AAoTL;;;;;AAKA8C,iBAzTK,yBAyTSxC,KAzTT,EAyTgBqC,QAzThB,EAyT0B;AAC3B,YAAI1C,OAAO;AACPY,oBAAQjF,KAAK+B,QADN;AAEP4C,oBAAQ3E,KAAK+E,QAFN;AAGPiC,8BAAkBlC,OAAOiC,QAAP;AAHX,SAAX;AAKA9G,uBAAeiF,WAAf,CAA2B9E,OAAOkC,IAAP,CAAY6E,OAAvC,EAAgD9C,IAAhD;AACH,KAhUI;;;AAkUL;;;;AAIAjB,iBAtUK,yBAsUSiB,IAtUT,EAsUe;AAChBC,gBAAQC,GAAR,CAAY,OAAZ,EAAqBF,IAArB;AACArE,aAAKgB,OAAL,CAAaoD,MAAb,GAAsB,KAAtB;AACH,KAzUI;;;AA2UL;;;;AAIAd,wBA/UK,gCA+UgBe,IA/UhB,EA+UsB;AACvBC,gBAAQC,GAAR,CAAY,UAAZ,EAAwBF,IAAxB;AACArE,aAAKyG,WAAL,GAAmBpC,KAAKM,MAAxB;AACA,YAAIN,KAAKM,MAAL,IAAe3E,KAAK+E,QAAxB,EAAkC;AAC9B/E,iBAAKmE,WAAL,CAAiBiD,SAAjB,CAA2B,IAA3B;AACH,SAFD,MAEO;AACHpH,iBAAK8D,OAAL,CAAaO,KAAKM,MAAlB,EAA0ByC,SAA1B,CAAoC,IAApC;AACH;AACJ,KAvVI;;;AAyVL;;;;AAIA5D,sBA7VK,8BA6Vca,IA7Vd,EA6VoB;AACrBC,gBAAQC,GAAR,CAAY,UAAZ,EAAwBF,IAAxB;AACArE,aAAK0G,cAAL,GAAsBrC,IAAtB;AAGH,KAlWI;;;AAoWL;;;AAGAgD,sBAvWK,gCAuWgB;AACjB,YAAIrH,KAAK0G,cAAT,EAAyB;;AAErB,gBAAIrC,OAAO;AACPY,wBAAQjF,KAAK+B,QADN;AAEP4C,wBAAQ3E,KAAK+E;AAFN,aAAX;AAIA9E,2BAAeiF,WAAf,CAA2B9E,OAAOkC,IAAP,CAAYgF,aAAvC,EAAsDjD,IAAtD;AACA,gBAAIkD,WAAW,SAAXA,QAAW,GAAW;AACtBvH,qBAAKmE,WAAL,CAAiBqD,eAAjB,CAAiCxH,KAAK4E,QAAL,CAAc6C,KAA/C,EAAqDzH,KAAK4E,QAAL,CAAc8C,UAAd,CAAyBD,KAA9E,EAAoFzH,KAAK4E,QAAL,CAAc8C,UAAd,CAAyBC,QAA7G;AACH,aAFD;AAGA3H,iBAAKmE,WAAL,CAAiByD,YAAjB,CAA8B5H,KAAK0G,cAAL,CAAoBmB,eAAlD,EAAmE7H,KAAK0G,cAAL,CAAoBoB,QAAvF,EAAiG9H,KAAK4E,QAAL,CAAc8C,UAAd,CAAyBK,OAA1H,EAAkIR,QAAlI;AACH;AACJ,KApXI;;;AAsXL;;;;AAIA7D,sBA1XK,8BA0XcW,IA1Xd,EA0XoB;AACrBC,gBAAQC,GAAR,CAAY,UAAZ,EAAwBF,IAAxB;AACA,YAAIkD,WAAW,SAAXA,QAAW,GAAW;AACtBvH,iBAAKmE,WAAL,CAAiBqD,eAAjB,CAAiCxH,KAAK8D,OAAL,CAAaO,KAAKM,MAAlB,EAA0B8C,KAA3D,EAAiEpD,KAAKqD,UAAL,CAAgBA,UAAhB,CAA2BD,KAA5F;AACH,SAFD;AAGAzH,aAAK8D,OAAL,CAAaO,KAAKM,MAAlB,EAA0BiD,YAA1B,CAAuCvD,KAAKqD,UAAL,CAAgBM,WAAvD,EAAoE3D,KAAKqD,UAAL,CAAgBO,KAAhB,CAAsB,CAAtB,CAApE,EAA8F5D,KAAKqD,UAAL,CAAgBK,OAA9G;AACH,KAhYI;;;AAkYL;;;;AAIAlB,gBAtYK,wBAsYQf,KAtYR,EAsYe;;AAEhB9F,aAAKyB,SAAL,CAAe2C,MAAf,GAAwB,KAAxB;AACA;AACA,YAAI0B,SAAS,CAAb,EAAgB;AACZ,iBAAKvE,YAAL,CAAkB2G,WAAlB,GAAgClI,KAAKqB,aAAL,CAAmB8G,aAAnB,CAAiC,gBAAjC,CAAhC;AACA,iBAAKC,QAAL,CAAc,EAAd;AACA;AACH,SAJD,MAIO,IAAItC,SAAS,CAAb,EAAgB;AACnB,iBAAKvE,YAAL,CAAkB2G,WAAlB,GAAgClI,KAAKqB,aAAL,CAAmB8G,aAAnB,CAAiC,gBAAjC,CAAhC;AACA,iBAAKC,QAAL,CAAc,EAAd;AACA;AACH,SAJM,MAIA,IAAItC,SAAS,CAAb,EAAgB;AACnB,iBAAKvE,YAAL,CAAkB2G,WAAlB,GAAgClI,KAAKqB,aAAL,CAAmB8G,aAAnB,CAAiC,gBAAjC,CAAhC;AACA,iBAAKC,QAAL,CAAc,EAAd;AACA;AACH,SAJM,MAIA,IAAItC,SAAS,CAAb,EAAgB;AACnB,iBAAKvE,YAAL,CAAkB2G,WAAlB,GAAgClI,KAAKqB,aAAL,CAAmB8G,aAAnB,CAAiC,gBAAjC,CAAhC;AACA;AACH,SAHM,MAGA,IAAIrC,SAAS,CAAb,EAAgB;AACnB,iBAAKvE,YAAL,CAAkB2G,WAAlB,GAAgClI,KAAKqB,aAAL,CAAmB8G,aAAnB,CAAiC,gBAAjC,CAAhC;AACA,iBAAKC,QAAL,CAAc,EAAd;AACH;AACJ,KA7ZI;;;AA+ZL;;;;AAIAA,YAnaK,oBAmaIC,YAnaJ,EAmakB;AACnBrI,aAAKyB,SAAL,CAAe6G,cAAf;AACAtI,aAAKyB,SAAL,CAAe2C,MAAf,GAAwB,IAAxB;AACA,aAAK1C,UAAL,CAAgB6G,MAAhB,GAAyBF,YAAzB;AACA,YAAIG,UAAUlI,GAAGmI,QAAH,CAAY,YAAY;AAClCJ,2BAAeA,eAAe,CAA9B;AACArI,iBAAK0B,UAAL,CAAgB6G,MAAhB,GAAyBF,YAAzB;AACA,gBAAIA,eAAe,CAAnB,EAAsB;AAClBrI,qBAAKyB,SAAL,CAAe2C,MAAf,GAAwB,KAAxB;AACH;AACJ,SANa,CAAd;AAOA,YAAIsE,QAAQpI,GAAGqI,SAAH,CAAa,CAAb,CAAZ;AACA,YAAIC,MAAMtI,GAAGuI,QAAH,CAAYH,KAAZ,EAAmBF,OAAnB,CAAV;AACA,YAAIM,MAAMxI,GAAGyI,MAAH,CAAUH,GAAV,EAAeP,eAAe,CAA9B,CAAV;AACArI,aAAKyB,SAAL,CAAeuH,SAAf,CAAyBF,GAAzB;AACH,KAlbI;;;AAobL;;;AAGAG,qBAvbK,+BAube;AAChB,YAAI5E,OAAO;AACPY,oBAAQjF,KAAK+B,QADN;AAEP4C,oBAAQ3E,KAAK+E;AAFN,SAAX;AAIA9E,uBAAeiF,WAAf,CAA2B9E,OAAOkC,IAAP,CAAY4G,mBAAvC,EAA4D7E,IAA5D;AACH;AA7bI,CAAT","file":"Game.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\resources\\Script\\view","sourcesContent":["var self;\r\nvar requestHandler = require(\"RequestHandler\");\r\nvar onfire = require(\"onfire\");\r\nvar events = require(\"CustomEvents\");\r\nvar GameData = require(\"GameData\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        playerNode: cc.Node,\r\n        seatNode: cc.Node,\r\n        btnReady: cc.Node,\r\n        bankerNode: cc.Node,\r\n        betNode: cc.Node,\r\n        operation: cc.Node,\r\n        centerNode: cc.Node,        //中心点\r\n        myPlayer: cc.Node,          //我的节点\r\n        buttonTest: cc.Node,\r\n\r\n        sf_tableAtlas: cc.SpriteAtlas, //牌资源\r\n\r\n        spStateLabel: cc.Sprite,    //状态描述文字\r\n        clockNode: cc.Node,          //闹钟节点\r\n        clockLabel: cc.Label,        //闹钟label\r\n\r\n\r\n\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n\r\n        self = this;\r\n        self.userInfo = GameData.getUserInfo();\r\n        self.roomCode = GameData.getRoomCode();\r\n        // 初始化控件\r\n        self.initWidget()\r\n        // 设置监听\r\n        var listenerList = [\r\n            [events.hall.HALL_DATA, this.onReceive_login, this],\r\n            [events.game.S2C_SEAT_CHOOSE, this.onReceive_sitDown, this],\r\n            [events.game.S2C_SYN_SEATS, this.onReceive_syn_seat, this],\r\n            [events.game.S2C_READY, this.onReceive_Ready, this],\r\n            [events.game.S2C_CARDS, this.onReceive_cards, this],\r\n            [events.game.S2C_GAME_STATE, this.onReceive_gameState, this],\r\n            [events.game.S2C_ROB_BANKER, this.onReceive_robBanker, this],\r\n            [events.game.S2C_BET, this.onReceive_bet, this],\r\n            [events.game.S2C_ROOM_BANKER, this.onReceive_roomBanker, this],\r\n            [events.game.S2C_LAST_CARD, this.onReceive_lastCard, this],\r\n            [events.game.S2C_OPEN_CARD, this.onReceive_openCard, this],\r\n\r\n\r\n\r\n\r\n        ]\r\n        listenerList.forEach(element => {\r\n            onfire.on(element[0], element[1], element[2]);\r\n        });\r\n\r\n    },\r\n\r\n    /**\r\n     * 初始化控件\r\n     */\r\n    initWidget() {\r\n        // 玩家\r\n        self.players = [];\r\n        // 座位\r\n        self.seats = [];\r\n        for (let index = 1; index < 13; index++) {\r\n            // 设置玩家\r\n            self.players[index] = self.playerNode.getChildByName(\"player\" + index).getComponent(\"Player\");\r\n            // 设置座位\r\n            self.seats[index] = self.seatNode.getChildByName(\"site\" + index)\r\n        }\r\n        self.myPlayerObj = self.myPlayer.getComponent(\"Player\");\r\n        self.btnReady.active = false;\r\n\r\n        // self.players[8].create();\r\n        // self.players[8].sendCardAction(this.centerNode);\r\n\r\n        // self.players[1].create();\r\n        // self.players[1].sendCardAction(this.centerNode);\r\n\r\n        // self.myPlayerObj.create();\r\n        // self.myPlayerObj.sendCardAction(this.centerNode);\r\n\r\n        // self.myPlayerObj.openLastCard([17, 18, 19, 20, 21], 21);\r\n\r\n    },\r\n\r\n    /**\r\n     * 登录返回结果\r\n     * @param {*} data \r\n     */\r\n    onReceive_login(data) {\r\n        console.log(\"进入游戏，接受数据：\", data)\r\n        self.userInfo = data.userInfo;\r\n        onfire.un(events.hall.HALL_DATA);\r\n    },\r\n    /**\r\n     * 坐下\r\n     * @param {*} seatId \r\n     */\r\n    sitDown(event, seatId) {\r\n\r\n        if (self.seatInfo && !self.seatInfo.ready) {\r\n            return;\r\n        }\r\n        seatId = Number(seatId);\r\n        if (self.mySeatId) {\r\n            // self.seats[self.mySeatId].active = true;\r\n            self.players[self.mySeatId].sitUp()\r\n        }\r\n\r\n        self.mySeatId = seatId;\r\n        console.log(\"选择座位：\", seatId);\r\n        var data = {\r\n            roomNo: self.roomCode,\r\n            seatId: seatId\r\n        }\r\n        requestHandler.sendRequest(events.game.C2S_SEAT_CHOOSE, data);\r\n    },\r\n\r\n    /**\r\n     * 收到坐下回调\r\n     * @param {*} data \r\n     */\r\n    onReceive_sitDown(data) {\r\n        // self.seats[self.mySeatId].active = false;\r\n        // self.players[self.mySeatId].create(self.userInfo)\r\n        console.log(\"坐下返回：\", data);\r\n    },\r\n\r\n    /**\r\n     * 同步坐下情况\r\n     * @param {*} data \r\n     */\r\n    onReceive_syn_seat(data) {\r\n        console.log(\"同步坐下玩家信息：\", data);\r\n        self.seatPlayers = data.seatPlayers;\r\n        var list = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]\r\n        data.seatPlayers.forEach(element => {\r\n            // 显示玩家数据\r\n            var seatId = element.seatIndex\r\n\r\n            // 隐藏坐下按钮\r\n            if(self.mySeatId){\r\n                self.seats[self.mySeatId].active = false;\r\n            }\r\n            \r\n            var index = list.indexOf(seatId);\r\n            list.splice(index, 1);\r\n\r\n            // 复制自己的信息\r\n            if (self.userInfo.uid == element.user.id) {\r\n                self.seatInfo = element;\r\n                self.btnReady.active = !element.ready;\r\n\r\n                if (!self.myPlayerObj.node.active) {\r\n                    self.players[seatId].create(element)\r\n                }\r\n                else if (self.state == 2) {\r\n                    self.myPlayerObj.setBetNum(element.robBankerBet)\r\n                }\r\n                else if (self.state == 3 && (!element.banker)) {\r\n                    self.myPlayerObj.setBetNum(element.bet)\r\n                }\r\n                else if (self.state == 6) {\r\n                    self.myPlayerObj.setBetNum(0)\r\n                }\r\n\r\n\r\n            } else {\r\n                if (!self.players[seatId].node.active) {\r\n                    self.players[seatId].create(element)\r\n                }\r\n                else if (self.state == 2) {\r\n                    self.players[seatId].setBetNum(element.robBankerBet)\r\n                }\r\n                else if (self.state == 3 && (!element.banker)) {\r\n                    self.players[seatId].setBetNum(element.bet)\r\n                }\r\n                else if (self.state == 6) {\r\n                    self.players[seatId].setBetNum(0)\r\n                }\r\n\r\n            }\r\n        });\r\n\r\n        // 显示其他 坐下按钮\r\n        list.forEach(element => {\r\n            self.seats[element].active = true;\r\n        });\r\n\r\n\r\n    },\r\n\r\n    sendReady() {\r\n        var data = {\r\n            roomNo: self.roomCode,\r\n            seatId: self.mySeatId\r\n        }\r\n        requestHandler.sendRequest(events.game.C2S_READY, data);\r\n    },\r\n\r\n    /**\r\n     * 准备 返回\r\n     * @param {*} data \r\n     */\r\n    onReceive_Ready(data) {\r\n        if (data.result == 0) {\r\n            self.myPlayerObj.create(self.seatInfo);\r\n            self.players[self.mySeatId].sitUp();\r\n        }\r\n    },\r\n\r\n    /**\r\n     *  发送牌数据\r\n     * @param {*} data \r\n     */\r\n    onReceive_cards(data) {\r\n        console.log(\"发送牌数据：\", data)\r\n\r\n        self.seatPlayers.forEach(element => {\r\n            if (self.userInfo.uid == element.user.id) {\r\n                self.myPlayerObj.sendCardAction(this.centerNode, data.playerCards)\r\n\r\n            } else {\r\n                self.players[element.seatIndex].sendCardAction(this.centerNode)\r\n            }\r\n\r\n        });\r\n    },\r\n\r\n    /**\r\n     * 游戏状态值\r\n     * @param {*} data \r\n     */\r\n    onReceive_gameState(data) {\r\n        console.log(\"游戏状态：\", data.state, data.currentGameNum)\r\n\r\n        // 设置状态值\r\n        self.state = data.state;\r\n\r\n        // 座位显示\r\n        self.seatNode.active = self.state == 0 || self.state == 6;\r\n        // 抢庄面板显示\r\n        self.bankerNode.active = self.state == 2;\r\n        // 下注倍数显示\r\n        self.betNode.active = self.state == 3 && self.bankerIndex != self.mySeatId;\r\n        // 摊牌按钮\r\n        self.operation.active = self.state == 4;\r\n        //未开始\r\n        if (data.state == 0) {\r\n\r\n            //开始游戏，发牌\r\n        } else if (data.state == 1) {\r\n            self.myLastCardData = null;\r\n\r\n            // 设置 准备状态消失\r\n            self.players.forEach(element => {\r\n                element.setReady(false);\r\n            });\r\n            //抢庄\r\n        } else if (data.state == 2) {\r\n\r\n            //普通玩家下注\r\n        } else if (data.state == 3) {\r\n            console.log(\"下注按钮：查看自己是否是庄家\", self.seatInfo.banker, self.state == 3 && (!self.seatInfo.banker));\r\n            //玩家看牌\r\n        } else if (data.state == 4) {\r\n\r\n            //所有人开牌\r\n        } else if (data.state == 5) {\r\n\r\n            //自动准备\r\n        } else if (data.state == 6) {\r\n\r\n            self.players.forEach(element => {\r\n                element.resetPlayer();\r\n            });\r\n        }\r\n\r\n        self.setGameState(self.state);\r\n    },\r\n\r\n\r\n    /**\r\n     * 抢庄\r\n     * @param {*} event \r\n     * @param {*} multiple \r\n     */\r\n    onClickForBanker(event, multiple) {\r\n        var data = {\r\n            roomNo: self.roomCode,\r\n            seatId: self.mySeatId,\r\n            betPointQuantity: Number(multiple)\r\n        }\r\n        requestHandler.sendRequest(events.game.C2S_ROB_BANKER, data);\r\n    },\r\n\r\n    /**\r\n     * 抢庄回调\r\n     * @param {*} data \r\n     */\r\n    onReceive_robBanker(data) {\r\n        console.log(\"抢庄回调：\", data);\r\n        self.bankerNode.active = false;\r\n    },\r\n\r\n\r\n\r\n    /**\r\n     * 下注\r\n     * @param {*} event \r\n     * @param {*} multiple \r\n     */\r\n    onClickForBet(event, multiple) {\r\n        var data = {\r\n            roomNo: self.roomCode,\r\n            seatId: self.mySeatId,\r\n            betPointQuantity: Number(multiple)\r\n        }\r\n        requestHandler.sendRequest(events.game.C2S_BET, data);\r\n    },\r\n\r\n    /**\r\n     * 下注回调\r\n     * @param {*} data \r\n     */\r\n    onReceive_bet(data) {\r\n        console.log(\"下注回调：\", data);\r\n        self.betNode.active = false;\r\n    },\r\n\r\n    /**\r\n     * 抢庄结果回调\r\n     * @param {*} data \r\n     */\r\n    onReceive_roomBanker(data) {\r\n        console.log(\"庄家ID 回调：\", data)\r\n        self.bankerIndex = data.seatId;\r\n        if (data.seatId == self.mySeatId) {\r\n            self.myPlayerObj.setBanker(true)\r\n        } else {\r\n            self.players[data.seatId].setBanker(true)\r\n        }\r\n    },\r\n\r\n    /**\r\n    * 接受最后一张牌\r\n    * @param {*} data \r\n    */\r\n    onReceive_lastCard(data) {\r\n        console.log(\"庄家ID 回调：\", data)\r\n        self.myLastCardData = data\r\n\r\n\r\n    },\r\n\r\n    /**\r\n     * 按钮开牌\r\n     */\r\n    onClickForOpenCard() {\r\n        if (self.myLastCardData) {\r\n\r\n            var data = {\r\n                roomNo: self.roomCode,\r\n                seatId: self.mySeatId\r\n            }\r\n            requestHandler.sendRequest(events.game.C2S_OPEN_CARD, data);\r\n            var setScore = function() {\r\n                self.myPlayerObj.showResultScore(self.seatInfo.score,self.seatInfo.playerCard.score,self.seatInfo.playerCard.cardType);\r\n            }\r\n            self.myPlayerObj.openLastCard(self.myLastCardData.playerCardsSort, self.myLastCardData.lastCard, self.seatInfo.playerCard.niuType,setScore);\r\n        }\r\n    },\r\n\r\n    /**\r\n    * \r\n    * @param {*} data \r\n    */\r\n    onReceive_openCard(data) {\r\n        console.log(\"庄家ID 回调：\", data)\r\n        var setScore = function() {\r\n            self.myPlayerObj.showResultScore(self.players[data.seatId].score,data.playerCard.playerCard.score);\r\n        }\r\n        self.players[data.seatId].openLastCard(data.playerCard.sortedCards, data.playerCard.cards[4], data.playerCard.niuType)\r\n    },\r\n\r\n    /**\r\n     * 设置状态\r\n     * @param {*} state \r\n     */\r\n    setGameState(state) {\r\n\r\n        self.clockNode.active = false;\r\n        //抢庄\r\n        if (state == 2) {\r\n            this.spStateLabel.spriteFrame = self.sf_tableAtlas._spriteFrames[\"AutoAtlas-1_10\"];\r\n            this.runClock(10);\r\n            //普通玩家下注\r\n        } else if (state == 3) {\r\n            this.spStateLabel.spriteFrame = self.sf_tableAtlas._spriteFrames[\"AutoAtlas-1_18\"];\r\n            this.runClock(10);\r\n            //玩家看牌\r\n        } else if (state == 4) {\r\n            this.spStateLabel.spriteFrame = self.sf_tableAtlas._spriteFrames[\"AutoAtlas-1_03\"];\r\n            this.runClock(10);\r\n            //所有人开牌\r\n        } else if (state == 5) {\r\n            this.spStateLabel.spriteFrame = self.sf_tableAtlas._spriteFrames[\"AutoAtlas-1_03\"];\r\n            //自动准备\r\n        } else if (state == 6) {\r\n            this.spStateLabel.spriteFrame = self.sf_tableAtlas._spriteFrames[\"AutoAtlas-1_06\"];\r\n            this.runClock(10);\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 开启闹钟\r\n     * @param {*} nTotalSecond \r\n     */\r\n    runClock(nTotalSecond) {\r\n        self.clockNode.stopAllActions();\r\n        self.clockNode.active = true;\r\n        this.clockLabel.string = nTotalSecond;\r\n        var cf_func = cc.callFunc(function () {\r\n            nTotalSecond = nTotalSecond - 1;\r\n            self.clockLabel.string = nTotalSecond;\r\n            if (nTotalSecond < 0) {\r\n                self.clockNode.active = false;\r\n            }\r\n        });\r\n        var delay = cc.delayTime(1);\r\n        var seq = cc.sequence(delay, cf_func);\r\n        var rep = cc.repeat(seq, nTotalSecond + 1);\r\n        self.clockNode.runAction(rep);\r\n    },\r\n\r\n    /**\r\n     * 测试按钮 \r\n     */\r\n    onClickButtonTest() {\r\n        var data = {\r\n            roomNo: self.roomCode,\r\n            seatId: self.mySeatId\r\n        }\r\n        requestHandler.sendRequest(events.game.C2S_RESET_GAMESTATE, data);\r\n    }\r\n\r\n});\r\n"]}
{"version":3,"sources":["../../../../../../../assets/resources/Script/view/prefabs/assets/resources/Script/view/prefabs/GameResult.js"],"names":["RESULT_DRAW","RESULT_WIN","RESULT_FAIL","onfire","require","tools","events","HallData","scenes","requestHandler","texts","consts","resultData","cc","Class","extends","Component","properties","sprPortraitTop","Sprite","sprPortraitLeft","sprPortraitRight","lblNameLeft","Label","lblNameRight","ndGenderLeftMale","Node","ndGenderRightMale","ndGenderLeftFemale","ndGenderRightFemale","lblScore","ndConfetti","ndFrameWin","ndFrameDraw","ndFrameFail","ndRibbonWin","ndRibbonDraw","ndRibbonFail","lblRibbonText","ndCloud","ndCrown","btnAgain","Button","sndWin","AudioSource","sndDraw","sndFail","onLoad","on","prefab","result","DATA","onResultData","data","un","console","log","JSON","stringify","loadRemoteImage","topPortrait","leftPortrait","rightPortrait","string","leftName","rightName","active","leftGender","gender","FEMALE","MALE","rightGender","play","node","color","Color","DRAW","FAIL","btnAgain_onClick","customEventData","director","loadScene","hall","READY","dt","appId","sendRequest","C2S_GAME_READY","btnBack_onClick","HALL","fire","HALL_DATA","rawData"],"mappings":"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","file":"GameResult.js","sourceRoot":"../../../../../../../assets/resources/Script/view/prefabs","sourcesContent":["const RESULT_DRAW = 0;\nconst RESULT_WIN = 1;\nconst RESULT_FAIL = -1;\n\nvar onfire = require(\"onfire\");\nvar tools = require(\"Tools\");\nvar events = require(\"CustomEvents\");\nvar HallData = require(\"HallData\");\nvar scenes = require(\"SceneList\");\nvar requestHandler = require(\"RequestHandler\");\nvar texts = require(\"Text\");\nvar consts = require(\"Constants\");\n\nvar resultData = null;\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        // 头像\n        sprPortraitTop: cc.Sprite,\n        sprPortraitLeft: cc.Sprite,\n        sprPortraitRight: cc.Sprite,\n\n        // 名称\n        lblNameLeft: cc.Label,\n        lblNameRight: cc.Label,\n\n        // 性别\n        ndGenderLeftMale: cc.Node,\n        ndGenderRightMale: cc.Node,\n        ndGenderLeftFemale: cc.Node,\n        ndGenderRightFemale: cc.Node,\n\n        // 比分\n        lblScore: cc.Label,\n\n        // 彩纸\n        ndConfetti: cc.Node,\n\n        // 框体\n        ndFrameWin: cc.Node,\n        ndFrameDraw: cc.Node,\n        ndFrameFail: cc.Node,\n\n        // 彩带\n        ndRibbonWin: cc.Node,\n        ndRibbonDraw: cc.Node,\n        ndRibbonFail: cc.Node,\n\n        // 彩带文字\n        lblRibbonText: cc.Label,\n\n        // 乌云\n        ndCloud: cc.Node,\n\n        // 皇冠\n        ndCrown: cc.Node,\n\n        // 再来一局\n        btnAgain: cc.Button,\n\n        // 音效\n        sndWin: cc.AudioSource,\n        sndDraw: cc.AudioSource,\n        sndFail: cc.AudioSource,\n    },\n\n    onLoad: function() {\n        // 获取结果数据\n        onfire.on(events.prefab.result.DATA, this.onResultData, this)\n    },\n\n    onResultData: function(data) {\n        onfire.un(events.prefab.result.DATA);\n        console.log(\"resultData:\", JSON.stringify(data));\n        resultData = data;\n\n        // 头像\n        tools.loadRemoteImage(data.topPortrait, this.sprPortraitTop);\n        tools.loadRemoteImage(data.leftPortrait, this.sprPortraitLeft);\n        tools.loadRemoteImage(data.rightPortrait, this.sprPortraitRight);\n\n        // 名称\n        this.lblNameLeft.string = data.leftName;\n        this.lblNameRight.string = data.rightName;\n\n        // 性别\n        this.ndGenderLeftFemale.active = (data.leftGender == consts.gender.FEMALE);\n        this.ndGenderLeftMale.active = (data.leftGender == consts.gender.MALE);\n        this.ndGenderRightFemale.active = (data.rightGender == consts.gender.FEMALE);\n        this.ndGenderRightMale.active = (data.rightGender == consts.gender.MALE);\n\n        // 根据结果进行对应处理\n        switch (data.result) {\n            case RESULT_WIN:\n                this.ndCloud.active = false;\n                this.ndFrameDraw.active = false;\n                this.ndFrameFail.active = false;\n                this.ndRibbonDraw.active = false;\n                this.ndRibbonFail.active = false;\n                this.sndWin.play();\n                break;\n\n            case RESULT_DRAW:\n                this.ndCloud.active = false;\n                this.ndCrown.active = false;\n                this.ndConfetti.active = false;\n                this.ndFrameWin.active = false;\n                this.ndFrameFail.active = false;\n                this.ndRibbonWin.active = false;\n                this.ndRibbonFail.active = false;\n                this.lblRibbonText.node.color = new cc.Color(3, 130, 43);\n                this.lblRibbonText.string = texts.result.DRAW;\n                this.sndDraw.play();\n                break;\n\n            case RESULT_FAIL:\n                this.ndCrown.active = false;\n                this.ndConfetti.active = false;\n                this.ndFrameWin.active = false;\n                this.ndFrameDraw.active = false;\n                this.ndRibbonDraw.active = false;\n                this.ndRibbonWin.active = false;\n                this.lblRibbonText.node.color = new cc.Color(255, 255, 255);\n                this.lblRibbonText.string = texts.result.FAIL;\n                this.sndFail.play();\n                break;\n        }\n    },\n\n    btnAgain_onClick: function (customEventData)\n    {\n        cc.director.loadScene(scenes.hall.READY, function () {\n            var dt = {\n                appId: resultData.appId,\n            };\n            requestHandler.sendRequest(events.hall.C2S_GAME_READY, dt);\n        });\n    },\n\n    btnBack_onClick: function (customEventData)\n    {\n        cc.director.loadScene(scenes.hall.HALL, function() {\n            onfire.fire(events.hall.HALL_DATA, HallData.rawData);\n        });\n    },\n\n});"]}
{"version":3,"sources":["Animal.js"],"names":["Com","require","cc","Class","extends","Component","properties","node_obj","default","type","Sprite","sp_animal","sp_icon","sp_mask_bottom","breakAni","Animation","nodeBreak","Node","sp_self","sp_tip_break","is_big","is_break","row","col","animalIndex","animalColor","onLoad","init","node","active","opacity","_touchCallback","_breakCallback","_objCode","addTouchListener","event","customEventData","onPlayGameEffect","onRunSmall","start","update","dt","onSetAnimalInfo","animalInfo","playAnimation","animationCall","animalCode","animState","play","self","console","log","onSetAnimalCode","onFinished","onLoadAnimal","onPlayEffect","on","onShowAnimal","destroy","onRunBig","bigFinishCall","seq","sequence","moveTo","p","scaleTo","callFunc","runAction","smallFinishCall","onMoveToTarget","moveData","callback","moveFinishCall","scale","moveEnd","targetPos","x","y","getAnimalIsBig","getAnimalIsBreak","onSetLocalZorder","zorder","setLocalZOrder","index","bottomColor","isBlue","animalResIdx","bottomImgUrl","onGetBottomImg","onLoadAnimalRes","bottom","mask","urlAnimal","onGetAnimalUrl","urlIcon","onGetAnimalIconUrl","spriteFrame","onSetSelf","imgUrl","targetNode","loader","loadRes","SpriteFrame","error","getComponent","onSetRowAndCol","onGetRowAndCol","obj","onDestory","onGetAnimalCode","onGetSelfColor","onGetAnimalIndex","onSetTouchCallback","touchcallback","onBreakBombCallback","breakcallback","onGetComponentStr","onHideTip","onShowSelfTip","onOptionalObj"],"mappings":"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","file":"Animal.js","sourceRoot":"../../../../../../../../assets/resources/Script/view/games/doushouqi","sourcesContent":["/**\n *  @brief: 小动物\n *  @time:  2018-05-5\n *  @author: JiangTao\n * \n *  点击后变大，在此点击后变回原来大小\n * \n *  @修改：服务器联调，点开箱子后，服务器才返回对应的动物。\n */\n\n\nvar Com = require('Com')\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        node_obj: {\n            default: null,\n            type: cc.Sprite,\n        },\n        sp_animal: {\n            default: null,\n            type: cc.Sprite,\n        },\n        sp_icon: {\n            default: null,\n            type: cc.Sprite,\n        },\n\n        // 动物底座\n        sp_mask_bottom: {\n            default: null,\n            type: cc.Sprite,\n        },\n\n        breakAni: {\n            default: null,\n            type: cc.Animation\n        },\n\n        nodeBreak: {\n            default: null,\n            type: cc.Node\n        },\n\n        sp_self: {\n            default: null,\n            type: cc.Sprite,\n        },\n\n        sp_tip_break: {\n            default: null,\n            type: cc.Sprite,\n        },\n\n        is_big: false,\n\n        is_break: false,\n\n        row:   -1,\n\n        col:   -1,\n\n        animalIndex: -1,\n\n        animalColor: \"\",    //  标记动物颜色，blue:蓝色动物 red：红色动物 默认是空的\n\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n\n        // this.init();\n\n    },\n\n    init: function () {\n\n        this.sp_self.node.active = false;\n\n        this.sp_tip_break.node.opacity = 0;\n\n        this.sp_tip_break.node.active = false;\n\n        this.sp_tip_break.node.opacity = 0;\n\n        this.is_big = false;    //当前是否被选中\n\n        this.is_break = false;\n\n        this._touchCallback = null;\n\n        this._breakCallback = null;\n\n        this._objCode       = -1;   //操作方的code 1:红方 2:蓝方 -1:还没有确定属于红蓝\n\n    },\n\n    // 监听点击事件\n    addTouchListener: function ( event, customEventData ) {\n\n        if ( customEventData == \"break\" ) {\n\n            Com.onPlayGameEffect( 0 );\n\n            if ( this._breakCallback ) {\n\n                this._breakCallback( this.row, this.col, \"Animal\" );\n\n            }\n\n        } else if ( customEventData == \"animal\" ) {\n\n            Com.onPlayGameEffect( 2 );\n\n            if ( this.is_big ) {\n\n                this.onRunSmall();\n            \n                if ( this._touchCallback ) {\n\n                    this._touchCallback( this.row, this.col, this._objCode, false );\n    \n                }\n\n            } else {\n\n                // this.onRunBig();\n\n                if ( this._touchCallback ) {\n\n                    this._touchCallback( this.row, this.col, this._objCode, true );\n    \n                }\n\n            }\n\n        }\n\n    },\n\n    start () {\n        // console.log(\" start +++++++++++++++++++++++++\")\n    },\n\n    update (dt) {\n        \n    },\n\n    onSetAnimalInfo: function ( animalInfo ) {\n\n        // 信息中包含 当前动物下标 根据下标找到对应的动物（判断出是红色还是蓝色）\n\n    },\n\n    // 播放爆开动画\n    playAnimation: function (  animationCall, animalIndex, animalCode ) {\n\n        var animState = this.breakAni.play('break');\n\n        var self = this;\n\n        console.log( \"playAnimation ====== \", animalCode );\n\n        this.onSetAnimalCode( animalCode )\n\n        function onFinished (  ) {\n\n            self.onLoadAnimal( animalIndex )\n\n            if ( animationCall ) {\n\n                animationCall( self.row, self.col );\n\n            }\n\n            Com.onPlayEffect( animalIndex );\n\n        };\n\n        animState.on('finished',  onFinished,  this.breakAni);\n\n    },\n\n    onShowAnimal: function (  ) {\n\n        this.is_break = true;\n\n        this.nodeBreak.destroy();\n\n        // 显示小动物\n        this.sp_animal.node.active = true;\n\n        this.sp_animal.node.opacity = 255;\n\n        this.sp_icon.node.active = true;\n\n        this.sp_icon.node.opacity = 255;\n\n        this.sp_mask_bottom.node.active = true;\n\n        this.sp_mask_bottom.node.opacity = 255;\n\n    },\n        \n    // 变大\n    onRunBig: function (   ) {\n\n        function bigFinishCall () {\n\n            this.is_big = true;\n\n        }\n\n        // cc.scaleTo(0.05, 1.1)\n\n        var seq =   cc.sequence(cc.moveTo(0.05, cc.p(0, 14)), \n                        cc.scaleTo(0.05, 1.1),\n                        cc.callFunc(bigFinishCall, this, this.node_obj));\n\n        this.node_obj.node.runAction(seq);\n\n    },\n\n    // 缩小\n    onRunSmall: function (   ) {\n\n        function smallFinishCall () {\n\n            this.is_big = false;\n\n        }\n\n        var seq =   cc.sequence(cc.moveTo(0.05, cc.p(0, 4)), \n                        cc.scaleTo(0.05, 1),\n                        cc.callFunc(smallFinishCall, this, this.node_obj));\n\n        this.node_obj.node.runAction(seq);\n\n    },\n\n    //移动位置\n    /**\n     * @brief: 移动\n     * @targetPos: 移动后的位置\n     * @row: 被吃掉棋子的横坐标\n     * @col：被吃的棋子的纵坐标\n     * @callback: 移动后的回调函数\n     * \n     * moveData = { targetPos:targetPos,    目标坐标位置\n     *              selectedRow:index0,     选择的行坐标\n     *              selectedCol:index1,     选择的列坐标\n     *              row:row,                目标行坐标\n     *              col:col,                目标列坐标\n     *              moveState:moveState     移动后的状态\n     *            };\n     */\n    onMoveToTarget: function ( moveData, callback ) {\n\n\n        var self = this;\n\n        function moveFinishCall () {\n\n            if ( callback ) {\n\n                callback( moveData );\n\n            }\n\n            self.is_big = false;\n\n            var scale = cc.scaleTo(0.05, 1);\n\n            self.node_obj.node.runAction( scale );\n\n        }\n\n        var moveEnd  = cc.moveTo(0.2, cc.p(moveData.targetPos.x, moveData.targetPos.y))\n\n        var seq =   cc.sequence(moveEnd,\n                                cc.callFunc(moveFinishCall, this, this.node));\n\n        this.node.runAction(seq);\n\n    },\n\n    // 获取当前对象是否变大了\n    getAnimalIsBig: function (  ) {\n\n        return this.is_big;\n\n    },\n\n    // 获取当前对象的箱子是否破裂\n    getAnimalIsBreak: function (  ) {\n\n        return this.is_break;\n\n    },\n\n    onSetLocalZorder: function ( zorder ) {\n\n        this.node.setLocalZOrder( zorder );\n\n    },\n\n    // 根据index变换资源 1-8\n    onLoadAnimal: function ( index ) {\n\n        // console.log(\" blue **************** \", index);\n        // 隐藏箱子\n\n        // 动物底座颜色\n        var bottomColor = \"blue\";\n\n        var isBlue      = false;\n\n        this.animalIndex = index;\n\n        var animalResIdx = index;\n\n        if ( index > 10 ) {\n\n            bottomColor = \"Animal_blue\";\n\n            animalResIdx = index - 10;\n\n            isBlue      = true;\n\n        } else {\n            \n            bottomColor = \"Animal_red\";\n\n            isBlue      = false;\n\n        }\n\n        // 动物底座颜色  动物下面的阴影\n        var bottomImgUrl = Com.onGetBottomImg( bottomColor );\n\n        this.onLoadAnimalRes( bottomImgUrl.bottom, this.node_obj );\n\n        this.onLoadAnimalRes( bottomImgUrl.mask, this.sp_mask_bottom );\n\n        var urlAnimal = Com.onGetAnimalUrl( animalResIdx );\n\n        var urlIcon = Com.onGetAnimalIconUrl( animalResIdx, isBlue );\n\n        // 动物头像\n        this.sp_animal.spriteFrame = urlAnimal;\n\n        // 动物名称\n        this.sp_icon.spriteFrame = urlIcon;\n\n        // 设置当前动物的颜色 蓝色 红色\n        this.onSetSelf( bottomColor );\n\n        this.onShowAnimal();\n\n    },\n\n    // \n    /**\n     * @brief: 动态更换动物图片\n     * @imgUrl: 动态加载图片\n     * @targetNode: 需要替换资源的对象\n     */\n    onLoadAnimalRes: function ( imgUrl, targetNode ) {\n\n        if ( !targetNode ) {\n\n            console.log( \" targetNode: \", targetNode );\n\n            return;\n        }\n\n        cc.loader.loadRes(imgUrl, cc.SpriteFrame, function (error, spriteFrame) {\n\n            if (!error) {\n\n                targetNode.getComponent(cc.Sprite).spriteFrame  = spriteFrame;\n\n            }\n\n        });\n\n    },\n\n    //  设置行 列坐标\n    onSetRowAndCol: function ( row, col ) {\n\n        this.row = row;\n\n        this.col = col;\n\n    },\n\n    // 获取行 列坐标\n    onGetRowAndCol: function (  ) {\n\n        var obj = {\n\n            \"row\": this.row,\n\n            \"col\": this.col,\n\n        };\n\n        return obj;\n\n    },\n\n    onDestory: function (  ) {\n\n        this.node.destroy();\n\n    },\n\n    onSetAnimalCode: function ( animalCode ) {\n\n        this._objCode  = animalCode;\n\n    },\n\n    onGetAnimalCode: function (  ) {\n\n        return this._objCode;\n\n    },\n\n    // 设置当前动物的颜色\n    onSetSelf: function ( animalColor ) {\n\n        this.animalColor = animalColor;\n\n    },\n\n    // 设置当前动物的颜色\n    onGetSelfColor: function (  ) {\n\n        return this.animalColor;\n\n    },\n\n    onGetAnimalIndex: function (  ) {\n\n        return this.animalIndex;\n\n    },\n\n    // 设置回调函数\n    onSetTouchCallback: function ( touchcallback ) {\n\n        this._touchCallback = touchcallback;\n\n    },\n\n    // 设置回调函数\n    onBreakBombCallback: function ( breakcallback ) {\n\n        this._breakCallback = breakcallback;\n\n    },\n\n    onGetComponentStr: function ( ) {\n\n        return this.animalColor;\n\n    },\n\n    // 箱子绿色框\n    onHideTip: function (  ) {\n\n        this.sp_tip_break.node.active = false;\n\n        this.sp_tip_break.node.opacity = 0;\n\n        this.sp_self.node.active = false;\n\n        this.sp_self.node.opacity = 0;\n\n    },\n\n    // 点开箱子后的动物框\n    onShowSelfTip: function (  ) {\n\n        this.sp_tip_break.node.active = false;\n\n        this.sp_tip_break.node.opacity = 0;\n\n        this.sp_self.node.active = true;\n\n        this.sp_self.node.opacity = 255;\n\n    },\n\n    /**\n     * 显示可以操作的对象\n     */\n    onOptionalObj: function (  ) {\n\n        if ( this.is_break ) {\n\n            this.sp_tip_break.node.active = false;\n\n            this.sp_tip_break.node.opacity = 0;\n\n            this.sp_self.node.active = true;\n\n            this.sp_self.node.opacity = 255;\n\n        } else {\n\n            this.sp_tip_break.node.active = true;\n\n            this.sp_tip_break.node.opacity = 255;\n\n            this.sp_self.node.active = false;\n\n            this.sp_self.node.opacity = 0;\n\n        }\n\n    },\n\n\n});\n\n"]}
{"version":3,"sources":["Lianliankan.js"],"names":["onfire","require","requestHandler","config","tools","consts","events","scenes","globalData","HallData","prefabHelper","myUserInfo","otherUserInfo","cc","Class","extends","Component","properties","btnBack","Button","btnHelp","ndHelp","Node","myHead","Sprite","myName","Label","myProgress","otherHead","otherName","otherProgress","myGenderM","myGenderF","otherGenderM","otherGenderF","spGrid","soundFinish","AudioSource","soundNoFinish","ndExitFrame","btnExitOK","btnExitCancel","spriteFrames","gameData","Array","imgNodeList","touchCount","touchImgId_1","touchImgId_2","connectData","checkFlag","animFramesList","finishCount","resultFrame","onLoad","$this","isNetwork","data","index","ran","Math","floor","random","tmp","onResourceLoaded","errorMessage","log","console","initImage","loader","loadResDir","SpriteFrame","length","listenerList","game","GAME_DATA","onReceive_login","lianliankan","S2C_START","onReceive_start","S2C_PLAY","onReceive_play","S2C_PROGRESS","onReceive_progress","S2C_GAMEOVER","onReceive_overGame","forEach","on","element","node","EventType","TOUCH_START","active","TOUCH_END","TOUCH_CANCEL","onDestroy","un","off","data1","data2","string","name","loadRemoteImage","icon","sex","gender","FEMALE","MALE","s_lianLianKan_progress","success","runEffect","result","youWin","resultData","topPortrait","leftPortrait","rightPortrait","leftName","rightName","leftGender","rightGender","appId","getCurGameInfo","createResultScreen","imgData","spaceX","spaceY","x","y","addChild","sprite","addComponent","spriteFrame","button","onClickImage","setImgEffect","nImgId","isRecover","scale","getComponent","createAnimation","id","animation","Animation","onFinished","maxIndex","frames","clip","AnimationClip","createWithSpriteFrames","ANI_RUN","addClip","anim","play","speed","createLine","lineData","line","inx","ax","ay","bx","by","rotation","height","abs","removeChildByTag","id1","id2","imgId","effectNode","anim1","pos1","getPosition","setPosition","anim2","pos2","event","customEventData","BUTTON_BACK","BUTTON_HELP","target","checkIsLink","isConnect","count","posList","imgId1","imgId2","sendRequest","C2S_PLAY","a","b","ret","checkLink_0","checkLink_1","checkLink_2","rett","push","aToPos1","pos1ToB","splice","concat","aToPos2","pos2ToB","ret1","onExitOK","token","C2S_EXIT_GAME","director","loadScene","hall","HALL","fire","HALL_DATA","rawData","onExitCancel"],"mappings":"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","file":"Lianliankan.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\..\\assets\\resources\\Script\\view\\games\\Lianliankan","sourcesContent":["var onfire = require(\"onfire\"); //处理事件的类库\r\nvar requestHandler = require(\"RequestHandler\");\r\nvar config = require(\"config\");\r\nvar tools = require(\"Tools\");\r\nvar consts = require(\"Constants\");\r\nvar events = require(\"CustomEvents\");\r\nvar scenes = require(\"SceneList\");\r\nvar globalData = require(\"Global\");\r\nvar HallData = require(\"HallData\");\r\nvar prefabHelper = require(\"PrefabHelper\");\r\nvar myUserInfo = null;\r\nvar otherUserInfo = null;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        btnBack: cc.Button,\r\n        btnHelp: cc.Button,\r\n        ndHelp: cc.Node,\r\n        myHead: cc.Sprite,\r\n        myName: cc.Label,\r\n        myProgress: cc.Label,\r\n        otherHead: cc.Sprite,\r\n        otherName: cc.Label,\r\n        otherProgress: cc.Label,\r\n        myGenderM: cc.Node,\r\n        myGenderF: cc.Node,\r\n        otherGenderM: cc.Node,\r\n        otherGenderF: cc.Node,\r\n        spGrid: cc.Node,\r\n\r\n        soundFinish: cc.AudioSource,\r\n        soundNoFinish: cc.AudioSource,\r\n\r\n        ndExitFrame: cc.Node,\r\n        btnExitOK: cc.Button,\r\n        btnExitCancel: cc.Button,\r\n\r\n        // icon资源\r\n        spriteFrames: null,\r\n\r\n        // 游戏数据\r\n        gameData: Array,\r\n\r\n        // 图片节点列表\r\n        imgNodeList: null,\r\n\r\n        // 点击图片次数 0为初始状态，1为点中了一张图片，2为点中两张图片（此时对比，并重置参数）\r\n        touchCount: 0,\r\n\r\n        // 点击图片1\r\n        touchImgId_1: 0,\r\n\r\n        // 点击图片2\r\n        touchImgId_2: 0,\r\n\r\n        // 连接数据\r\n        connectData: null,\r\n\r\n        // 检查标识\r\n        checkFlag: 0,\r\n\r\n        // 动画帧数组\r\n        animFramesList: null,\r\n\r\n        finishCount: 0,\r\n\r\n        resultFrame: cc.Node,\r\n    },\r\n\r\n    // 创建监听\r\n    onLoad() {\r\n        var $this = this;\r\n\r\n        // 单机模式\r\n        if (!config.isNetwork) {\r\n            var data = [\r\n                1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7,\r\n            ]\r\n            for (let index = 0; index < 69; index++) {\r\n                var ran = Math.floor(Math.random() * 69);\r\n                var tmp = data[index];\r\n                data[index] = data[ran];\r\n                data[ran] = tmp;\r\n\r\n            }\r\n            this.gameData = data\r\n            var onResourceLoaded = function(errorMessage, spriteFrames) {\r\n                //检查失败原因\r\n                if (errorMessage) {\r\n                    cc.log('加载失败, 原因:' + errorMessage);\r\n                    return;\r\n                }\r\n                $this.spriteFrames = spriteFrames;\r\n                console.log(\"-----  onload -- loadImg end\")\r\n                $this.initImage(spriteFrames, data)\r\n\r\n            };\r\n            //這邊才是真的使用cc.loader進行載入，並且呼叫我們上面寫的方法\r\n            cc.loader.loadResDir(\"games/lianliankan/icon\", cc.SpriteFrame, onResourceLoaded);\r\n        }\r\n        // 加载动画资源\r\n        cc.loader.loadResDir(\"games/lianliankan/effect/\", cc.SpriteFrame, function(errorMessage, spriteFrames) {\r\n            console.log(spriteFrames, spriteFrames.length);\r\n            $this.animFramesList = spriteFrames;\r\n        });\r\n\r\n        // 网络监听列表\r\n        var listenerList = [\r\n            [events.game.GAME_DATA, this.onReceive_login, this],\r\n            [events.game.lianliankan.S2C_START, this.onReceive_start, this],\r\n            [events.game.lianliankan.S2C_PLAY, this.onReceive_play, this],\r\n            [events.game.lianliankan.S2C_PROGRESS, this.onReceive_progress, this],\r\n            [events.game.lianliankan.S2C_GAMEOVER, this.onReceive_overGame, this],\r\n        ]\r\n        listenerList.forEach(element => {\r\n            onfire.on(element[0], element[1], element[2]);\r\n        });\r\n\r\n        this.btnHelp.node.on(cc.Node.EventType.TOUCH_START, function() {\r\n            this.ndHelp.active = true;\r\n        }, this);\r\n        this.btnHelp.node.on(cc.Node.EventType.TOUCH_END, function() {\r\n            this.ndHelp.active = false;\r\n        }, this);\r\n        this.btnHelp.node.on(cc.Node.EventType.TOUCH_CANCEL, function() {\r\n            this.ndHelp.active = false;\r\n        }, this);\r\n    },\r\n\r\n    // 销毁时调用\r\n    onDestroy() {\r\n        // 移除监听\r\n        var listenerList = [\r\n            [events.game.GAME_DATA, this.onReceive_login, this],\r\n            [events.game.lianliankan.S2C_START, this.onReceive_start, this],\r\n            [events.game.lianliankan.S2C_PLAY, this.onReceive_play, this],\r\n            [events.game.lianliankan.S2C_PROGRESS, this.onReceive_progress, this],\r\n            [events.game.lianliankan.S2C_GAMEOVER, this.onReceive_overGame, this],\r\n        ]\r\n        listenerList.forEach(element => {\r\n            onfire.un(element[0]);\r\n        });\r\n\r\n        this.btnHelp.node.off(cc.Node.EventType.TOUCH_START);\r\n        this.btnHelp.node.on(cc.Node.EventType.TOUCH_END);\r\n        this.btnHelp.node.on(cc.Node.EventType.TOUCH_CANCEL);\r\n    },\r\n\r\n    // 进入游戏\r\n    onReceive_login(data1, data2) {\r\n\r\n        console.log(data1, typeof(data1));\r\n        console.log(data1.gameData, typeof(data1.gameData));\r\n\r\n        this.gameData = data1.gameData;\r\n        var $this = this;\r\n        var onResourceLoaded = function(errorMessage, spriteFrames) {\r\n            //检查失败原因\r\n            if (errorMessage) {\r\n                cc.log('加载失败, 原因:' + errorMessage);\r\n                return;\r\n            }\r\n            $this.spriteFrames = spriteFrames;\r\n            $this.initImage(spriteFrames, $this.gameData)\r\n\r\n        };\r\n        //這邊才是真的使用cc.loader進行載入，並且呼叫我們上面寫的方法\r\n        cc.loader.loadResDir(\"games/lianliankan/icon\", cc.SpriteFrame, onResourceLoaded);\r\n\r\n        // 初始化用户数据\r\n        myUserInfo = data1.myUserInfo;\r\n        otherUserInfo = data1.otherUserInfo;\r\n        this.myName.string = data1.myUserInfo.name;\r\n        this.otherName.string = data1.otherUserInfo.name;\r\n        tools.loadRemoteImage(myUserInfo.icon, this.myHead);\r\n        tools.loadRemoteImage(otherUserInfo.icon, this.otherHead);\r\n        this.myGenderF.active = (myUserInfo.sex == consts.gender.FEMALE);\r\n        this.myGenderM.active = (myUserInfo.sex == consts.gender.MALE);\r\n        this.otherGenderF.active = (otherUserInfo.sex == consts.gender.FEMALE);\r\n        this.otherGenderM.active = (otherUserInfo.sex == consts.gender.MALE);\r\n\r\n        // 设置进度\r\n        this.onReceive_progress(data1.s_lianLianKan_progress);\r\n    },\r\n    // 游戏开始\r\n    onReceive_start(data1, data2) {\r\n        console.log(\"--------s_lianLianKan_start--------\")\r\n    },\r\n    // 消除图片\r\n    onReceive_play(data1, data2) {\r\n        if (data1.success == 0) {\r\n            this.imgNodeList[this.touchImgId_1].active = false;\r\n            this.imgNodeList[this.touchImgId_2].active = false;\r\n            // 效果\r\n            this.runEffect(this.touchImgId_1, this.touchImgId_2, this.connectData);\r\n            this.gameData[this.touchImgId_2] = 0;\r\n            this.gameData[this.touchImgId_1] = 0;\r\n        }\r\n\r\n    },\r\n    // 对方进度\r\n    onReceive_progress(data1, data2) {\r\n\r\n        this.myProgress.string = Math.floor(data1.myProgress / 35 * 100) + \"%\";\r\n        this.otherProgress.string = Math.floor(data1.otherProgress / 35 * 100) + \"%\";\r\n    },\r\n    // 游戏结束\r\n    onReceive_overGame(data1, data2) {\r\n        var result = data1.youWin;\r\n        var resultData = {};\r\n        if (!config.isNetwork) {\r\n            resultData.topPortrait = \"http://zyhdheads.oss-cn-beijing.aliyuncs.com/default1.png\";\r\n            resultData.leftPortrait = \"http://zyhdheads.oss-cn-beijing.aliyuncs.com/default1.png\";\r\n            resultData.rightPortrait = \"http://zyhdheads.oss-cn-beijing.aliyuncs.com/default1.png\";\r\n            resultData.leftName = \"左边的玩家\";\r\n            resultData.rightName = \"右边的玩家\";\r\n            resultData.leftGender = 1; // 左边性别 0:男 1:女\r\n            resultData.rightGender = 0; // 右边性别 0:男 1:女\r\n            resultData.result = 1; // 结果 1:胜利 0:平局 -1:失败\r\n            resultData.appId = 2; // 游戏id\r\n        } else {\r\n            resultData.topPortrait = myUserInfo.icon;\r\n            resultData.leftPortrait = myUserInfo.icon;\r\n            resultData.rightPortrait = otherUserInfo.icon;\r\n            resultData.leftName = myUserInfo.name;\r\n            resultData.rightName = otherUserInfo.name;\r\n            resultData.leftGender = myUserInfo.sex;\r\n            resultData.rightGender = otherUserInfo.sex;\r\n            resultData.result = result;\r\n            resultData.appId = HallData.getCurGameInfo().appId;\r\n        }\r\n        prefabHelper.createResultScreen(this.resultFrame, resultData);\r\n    },\r\n\r\n\r\n\r\n    // 创建图片\r\n    initImage: function(spriteFrames, imgData) {\r\n\r\n        var spaceX = 76;\r\n        var spaceY = 76;\r\n        this.imgNodeList = [];\r\n        var $this = this;\r\n        for (let index = 0; index < imgData.length; index++) {\r\n            var node = new cc.Node('sprite' + index)\r\n            // 设置位置\r\n            node.x = index % 7 * spaceX + 38\r\n            node.y = -Math.floor(index / 7) * spaceY - 38\r\n            this.spGrid.addChild(node);\r\n            //调用新建的node的addComponent函数，会返回一个sprite的对象  \r\n            const sprite = node.addComponent(cc.Sprite)\r\n            //给sprite的spriteFrame属性 赋值  \r\n            sprite.spriteFrame = spriteFrames[imgData[index] - 1];\r\n            // 赋值给list\r\n            this.imgNodeList[index] = node;\r\n            var button = node.addComponent(cc.Button);\r\n            button.node.on('click', function() {\r\n                $this.onClickImage({\r\n                    \"target\": this.imgNodeList[index]\r\n                }, index)\r\n            }, this);\r\n        }\r\n\r\n    },\r\n\r\n    // 设置点击效果\r\n    setImgEffect: function(nImgId, isRecover) {\r\n        if (isRecover) {\r\n            this.imgNodeList[nImgId].scale = 1\r\n            var sprite = this.imgNodeList[nImgId].getComponent(cc.Sprite);\r\n            sprite.spriteFrame = this.spriteFrames[this.gameData[nImgId] - 1];\r\n        } else {\r\n            this.imgNodeList[nImgId].scale = 1.2\r\n            var sprite = this.imgNodeList[nImgId].getComponent(cc.Sprite);\r\n            sprite.spriteFrame = this.spriteFrames[this.gameData[nImgId] + 6];\r\n        }\r\n    },\r\n\r\n    // 创建动画\r\n    createAnimation(id) {\r\n\r\n        var node = new cc.Node(\"effect_\" + id);\r\n        node.scale = 0.6;\r\n        node.addComponent(cc.Sprite);\r\n        var animation = node.addComponent(cc.Animation);\r\n        // 注册\r\n\r\n        animation.on('finished', this.onFinished, this);\r\n\r\n        // frames 这是一个 SpriteFrame 的数组.\r\n        var maxIndex = id * 3;\r\n        var frames = [\r\n            this.animFramesList[maxIndex - 1],\r\n            this.animFramesList[maxIndex - 2],\r\n            this.animFramesList[maxIndex - 3],\r\n            this.animFramesList[maxIndex - 3],\r\n        ];\r\n\r\n        var clip = cc.AnimationClip.createWithSpriteFrames(frames, 4);\r\n        clip.name = consts.game.lianliankan.ANI_RUN;\r\n        animation.addClip(clip);\r\n        var anim = animation.play(consts.game.lianliankan.ANI_RUN);\r\n        anim.speed = 6;\r\n        return node\r\n\r\n    },\r\n\r\n    // 创建线\r\n    createLine(connectData) {\r\n\r\n        var node = new cc.Node();\r\n        var lineData = connectData.line;\r\n        var spaceX = 76;\r\n        var spaceY = 76;\r\n\r\n        for (let index = 0; index < lineData.length / 2; index++) {\r\n            var line = new cc.Node();\r\n            node.addChild(line);\r\n            var sprite = line.addComponent(cc.Sprite);\r\n            sprite.spriteFrame = this.animFramesList[21];\r\n\r\n            var inx = index * 2;\r\n            var ax = lineData[inx][0] * spaceX + 38\r\n            var ay = -lineData[inx][1] * spaceY - 38\r\n            var bx = lineData[inx + 1][0] * spaceX + 38\r\n            var by = -lineData[inx + 1][1] * spaceY - 38\r\n            line.x = (ax + bx) / 2;\r\n            line.y = (ay + by) / 2;\r\n\r\n            if (lineData[inx][1] == lineData[inx + 1][1]) {\r\n                line.rotation = 90\r\n                sprite.node.height = Math.abs(ax - bx);\r\n            } else {\r\n                sprite.node.height = Math.abs(ay - by);\r\n            }\r\n            console.log(\"---- :\", line.height);\r\n        }\r\n\r\n        return node;\r\n    },\r\n\r\n    // 动画结束\r\n    onFinished() {\r\n        console.log(\"onFinished\");\r\n        this.spGrid.removeChildByTag(101);\r\n    },\r\n    // 消除效果\r\n    runEffect(id1, id2, connectData) {\r\n        console.log(\"消除：\", id1, id2);\r\n        var imgId = this.gameData[id1];\r\n        if (imgId == 0) {\r\n            return;\r\n        }\r\n        var effectNode = new cc.Node();\r\n        this.spGrid.addChild(effectNode, 1, 101);\r\n\r\n        // 创建线条\r\n        // var line = this.createLine(connectData);\r\n        // effectNode.addChild(line);\r\n\r\n        var anim1 = this.createAnimation(imgId)\r\n        var pos1 = this.imgNodeList[id1].getPosition();\r\n        console.log(\"position1:\", pos1.x, pos1.y);\r\n        anim1.setPosition(pos1);\r\n        effectNode.addChild(anim1);\r\n\r\n        var anim2 = this.createAnimation(imgId)\r\n        var pos2 = this.imgNodeList[id2].getPosition();\r\n        anim2.setPosition(pos2);\r\n        effectNode.addChild(anim2);\r\n    },\r\n\r\n    // 点击图片\r\n    onClickImage: function(event, customEventData) {\r\n        // var node = event.target;\r\n        // var sprite = node.getComponent(cc.Sprite);\r\n\r\n        console.log(customEventData, this.gameData[customEventData]);\r\n        if (customEventData == consts.game.lianliankan.BUTTON_BACK) {\r\n            // 退出\r\n            this.ndExitFrame.active = true;\r\n        } else if (customEventData == consts.game.lianliankan.BUTTON_HELP) {\r\n            // 教程\r\n\r\n        } else {\r\n            var node = event.target;\r\n            var sprite = node.getComponent(cc.Sprite);\r\n            // 换图\r\n            this.setImgEffect(customEventData)\r\n            // 点击图片处理\r\n            if (this.touchCount == 0) {\r\n                this.touchImgId_1 = customEventData;\r\n                this.touchCount = 1;\r\n            } else if (this.touchCount == 1) {\r\n                this.touchCount = 0;\r\n                this.touchImgId_2 = customEventData;\r\n                if (customEventData == this.touchImgId_1) {\r\n                    this.setImgEffect(customEventData, true)\r\n                } else {\r\n                    if (this.gameData[customEventData] == this.gameData[this.touchImgId_1]) {\r\n                        // 选中两个一样的\r\n                        this.connectData = this.checkIsLink(this.touchImgId_1, customEventData);\r\n\r\n                        if (this.connectData.isConnect) {\r\n                            console.log(\"几折：\", this.connectData.count);\r\n                            console.log(\"路线：\", this.connectData.posList);\r\n                            // 网络模式\r\n                            if (config.isNetwork) {\r\n                                var data = {\r\n                                    imgId1: this.touchImgId_1,\r\n                                    imgId2: this.touchImgId_2,\r\n                                    // posList:this.connectData[\"posList\"]\r\n                                };\r\n                                requestHandler.sendRequest(events.game.lianliankan.C2S_PLAY, data);\r\n                            } else {\r\n                                node.active = false;\r\n                                this.imgNodeList[this.touchImgId_1].active = false;\r\n                                // 效果\r\n                                this.runEffect(this.touchImgId_1, this.touchImgId_2, this.connectData);\r\n                                this.gameData[this.touchImgId_2] = 0;\r\n                                this.gameData[this.touchImgId_1] = 0;\r\n\r\n                                this.finishCount = this.finishCount + 1;\r\n                                this.onReceive_progress({\r\n                                    myProgress: this.finishCount,\r\n                                    otherProgress: 0\r\n                                });\r\n\r\n                            }\r\n                            this.soundFinish.play();\r\n                        } else {\r\n                            // 重置图片\r\n                            this.setImgEffect(customEventData, true);\r\n                            this.setImgEffect(this.touchImgId_1, true)\r\n                            this.soundNoFinish.play();\r\n                        }\r\n                    } else {\r\n                        // 重置图片\r\n                        this.setImgEffect(customEventData, true);\r\n                        this.setImgEffect(this.touchImgId_1, true)\r\n                        this.soundNoFinish.play();\r\n                    }\r\n                }\r\n\r\n\r\n            }\r\n\r\n        }\r\n    },\r\n\r\n    // 连连看连接算法\r\n    checkIsLink: function(a, b) {\r\n        // 解析a,b位置信息\r\n        var ay = Math.floor(a / 7);\r\n        var ax = a % 7;\r\n        var by = Math.floor(b / 7);\r\n        var bx = b % 7;\r\n        // 检测0折情况\r\n        this.checkFlag = 0\r\n        var ret = this.checkLink_0(ax, ay, bx, by);\r\n        if (ret.isConnect) {\r\n            return ret\r\n        }\r\n        // 检测1折情况\r\n        this.checkFlag = 1\r\n        ret = this.checkLink_1(ax, ay, bx, by);\r\n        if (ret.isConnect) {\r\n            return ret\r\n        }\r\n        // 检测2折情况\r\n        this.checkFlag = 2\r\n        ret = this.checkLink_2(ax, ay, bx, by);\r\n        if (ret.isConnect) {\r\n            return ret\r\n        }\r\n\r\n        var rett = {\r\n            isConnect: false\r\n        }\r\n        return rett;\r\n    },\r\n\r\n    // 检测0折\r\n    checkLink_0: function(ax, ay, bx, by) {\r\n        var ret = {\r\n            isConnect: false\r\n        }\r\n        // 在同一列\r\n        if (ax == bx) {\r\n            // 几折\r\n            ret.count = 0;\r\n            // 经过的点\r\n            ret.posList = [];\r\n            // 上--》下\r\n            if (ay < by) {\r\n                for (let index = ay; index <= by; index++) {\r\n                    if (index == ay || index == by || this.gameData[index * 7 + ax] == 0) {\r\n                        ret.isConnect = true;\r\n                        ret.posList.push([ax, index]);\r\n                    } else {\r\n                        ret.posList = [];\r\n                        ret.isConnect = false;\r\n                        break;\r\n                    }\r\n                }\r\n                //  下--》上 \r\n            } else {\r\n                for (let index = ay; index >= by; index--) {\r\n                    if (index == ay || index == by || this.gameData[index * 7 + ax] == 0) {\r\n                        ret.isConnect = true;\r\n                        ret.posList.push([ax, index]);\r\n                    } else {\r\n                        ret.posList = [];\r\n                        ret.isConnect = false;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if ((this.checkFlag < 2 && ax == 0 || ax == 6) || ret[\"isConnect\"]) {\r\n                // 是否连接\r\n                if (ret.isConnect) {\r\n                    ret.line = [\r\n                        [ax, ay],\r\n                        [bx, by],\r\n                    ];\r\n                } else {\r\n                    if (ax == 0) {\r\n                        ret.line = [\r\n                            [ax, ay, \"left\"],\r\n                            [bx, by], \"left\",\r\n                        ];\r\n                    } else if (ax == 6) {\r\n                        ret.line = [\r\n                            [ax, ay, \"right\"],\r\n                            [bx, by, \"right\"],\r\n                        ];\r\n                    }\r\n                }\r\n\r\n                ret.isConnect = true;\r\n                return ret;\r\n            }\r\n\r\n        }\r\n\r\n        // 在同一行\r\n        if (ay == by) {\r\n            // 几折\r\n            ret.count = 0;\r\n            // 经过的点\r\n            ret.posList = [];\r\n            // 左--》右\r\n            if (ax < bx) {\r\n                for (let index = ax; index <= bx; index++) {\r\n                    if (index == ax || index == bx || this.gameData[ay * 7 + index] == 0) {\r\n                        ret.isConnect = true;\r\n                        ret.posList.push([ax, index]);\r\n                    } else {\r\n                        ret.posList = [];\r\n                        ret.isConnect = false;\r\n                        break;\r\n                    }\r\n                }\r\n                //  右--》左\r\n            } else {\r\n                for (let index = ax; index >= bx; index--) {\r\n                    if (index == ax || index == bx || this.gameData[ay * 7 + index] == 0) {\r\n                        ret.isConnect = true;\r\n                        ret.posList.push([ax, index]);\r\n                    } else {\r\n                        ret.posList = [];\r\n                        ret.isConnect = false;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if ((this.checkFlag < 2 && ay == 0 || ay == 9) || ret.isConnect) {\r\n                // 是否连接\r\n                if (ret.isConnect) {\r\n                    ret.line = [\r\n                        [ax, ay],\r\n                        [bx, by],\r\n                    ];\r\n                } else {\r\n                    if (ay == 0) {\r\n                        ret.line = [\r\n                            [ax, ay, \"up\"],\r\n                            [bx, by], \"up\",\r\n                        ];\r\n                    } else if (ay == 9) {\r\n                        ret.line = [\r\n                            [ax, ay, \"down\"],\r\n                            [bx, by, \"down\"],\r\n                        ];\r\n                    }\r\n                }\r\n\r\n                ret.isConnect = true;\r\n                return ret;\r\n            }\r\n\r\n        }\r\n        return ret\r\n    },\r\n    // 检测1折\r\n    checkLink_1: function(ax, ay, bx, by) {\r\n\r\n        var ret = {\r\n            isConnect: false,\r\n            count: 1,\r\n            posList: [],\r\n        }\r\n        // 一折情况：两个点组成矩形，找到另一个对角的两个关键点，分别连接 起始点，\r\n        if (this.gameData[by * 7 + ax] == 0) {\r\n            var aToPos1 = this.checkLink_0(ax, ay, ax, by);\r\n            if (aToPos1.isConnect) {\r\n                var pos1ToB = this.checkLink_0(ax, by, bx, by);\r\n                if (pos1ToB.isConnect) {\r\n                    ret.isConnect = true;\r\n                    aToPos1.posList.splice(aToPos1.posList.length - 1, 1);\r\n                    ret.posList = aToPos1.posList.concat(pos1ToB.posList);\r\n                    ret.line = aToPos1.line.concat(pos1ToB.line);\r\n                    console.log(\"1折路线1：\", ret.posList)\r\n                    return ret\r\n                }\r\n            }\r\n        }\r\n        if (this.gameData[ay * 7 + bx] == 0) {\r\n            var aToPos2 = this.checkLink_0(ax, ay, bx, ay);\r\n            if (aToPos2.isConnect) {\r\n                var pos2ToB = this.checkLink_0(bx, ay, bx, by);\r\n                if (pos2ToB.isConnect) {\r\n                    ret.isConnect = true;\r\n                    aToPos2.posList.splice(aToPos2.posList.length - 1, 1);\r\n                    ret.posList = aToPos2.posList.concat(pos2ToB.posList);\r\n                    ret.line = aToPos2.line.concat(pos2ToB.line);\r\n                    console.log(\"1折路线2：\", ret.posList)\r\n                    return ret\r\n                }\r\n            }\r\n        }\r\n        return ret\r\n    },\r\n    // 检测2折\r\n    checkLink_2: function(ax, ay, bx, by) {\r\n        var ret = {\r\n            isConnect: false,\r\n            count: 2,\r\n            posList: [],\r\n        }\r\n        // 上下左右四个方向，寻找1折线路\r\n        // 上\r\n        for (let index = ay; index >= 0; index--) {\r\n            if (index == ay) {\r\n                ret.posList.push([ax, ay])\r\n            } else if (this.gameData[index * 7 + ax] == 0) {\r\n                ret.posList.push([ax, index])\r\n                var ret1 = this.checkLink_1(ax, index, bx, by)\r\n                if (ret1.isConnect) {\r\n                    ret.isConnect = true;\r\n                    ret.posList.splice(ret.posList.length - 1, 1);\r\n                    ret.posList = ret.posList.concat(ret1.posList);\r\n\r\n                    ret.line = [\r\n                        [ax, ay],\r\n                        [ax, index]\r\n                    ];\r\n                    ret.line = ret.line.concat(ret1.line);\r\n                    return ret;\r\n                    break;\r\n                }\r\n            } else {\r\n                ret.posList = []\r\n                break\r\n            }\r\n        }\r\n        // 下\r\n        for (let index = ay; index <= 9; index++) {\r\n            if (index == ay) {\r\n                ret.posList.push([ax, ay])\r\n            } else if (this.gameData[index * 7 + ax] == 0) {\r\n                ret.posList.push([ax, index])\r\n                var ret1 = this.checkLink_1(ax, index, bx, by)\r\n                if (ret1.isConnect) {\r\n                    ret.isConnect = true;\r\n                    ret.posList.splice(ret.posList.length - 1, 1);\r\n                    ret.posList = ret.posList.concat(ret1.posList);\r\n\r\n                    ret.line = [\r\n                        [ax, ay],\r\n                        [ax, index]\r\n                    ];\r\n                    ret.line = ret.line.concat(ret1.line);\r\n                    return ret;\r\n                    break;\r\n                }\r\n            } else {\r\n                ret.posList = []\r\n                break\r\n            }\r\n        }\r\n        // 左\r\n        for (let index = ax; index >= 0; index--) {\r\n            if (index == ax) {\r\n                ret.posList.push([ax, ay])\r\n            } else if (this.gameData[ay * 7 + index] == 0) {\r\n                ret.posList.push([index, ay])\r\n                var ret1 = this.checkLink_1(index, ay, bx, by)\r\n                if (ret1.isConnect) {\r\n                    ret.isConnect = true;\r\n                    ret.posList.splice(ret.posList.length - 1, 1);\r\n                    ret.posList = ret.posList.concat(ret1.posList);\r\n\r\n                    ret.line = [\r\n                        [ax, ay],\r\n                        [index, ay]\r\n                    ];\r\n                    ret.line = ret.line.concat(ret1.line);\r\n                    return ret;\r\n                    break;\r\n                }\r\n            } else {\r\n                ret.posList = []\r\n                break\r\n            }\r\n        }\r\n        // 右\r\n        for (let index = ax; index <= 6; index++) {\r\n            if (index == ax) {\r\n                ret.posList.push([ax, ay])\r\n            } else if (this.gameData[ay * 7 + index] == 0) {\r\n                ret.posList.push([index, ay])\r\n                var ret1 = this.checkLink_1(index, ay, bx, by)\r\n                if (ret1.isConnect) {\r\n                    ret.isConnect = true;\r\n                    ret.posList.splice(ret.posList.length - 1, 1);\r\n                    ret.posList = ret.posList.concat(ret1.posList);\r\n\r\n                    ret.line = [\r\n                        [ax, ay],\r\n                        [index, ay]\r\n                    ];\r\n                    ret.line = ret.line.concat(ret1.line);\r\n                    return ret;\r\n                    break;\r\n                }\r\n            } else {\r\n                ret.posList = []\r\n                break\r\n            }\r\n        }\r\n\r\n        return ret\r\n    },\r\n\r\n    onExitOK: function(customEventData) {\r\n        // 退出\r\n        var data = {\r\n            appId: HallData.getCurGameInfo().appId,\r\n            token: globalData.myUserInfo.token,\r\n        };\r\n        requestHandler.sendRequest(events.game.C2S_EXIT_GAME, data);\r\n        cc.director.loadScene(scenes.hall.HALL, function() {\r\n            onfire.fire(events.hall.HALL_DATA, HallData.rawData);\r\n        });\r\n    },\r\n\r\n    onExitCancel: function(customEventData) {\r\n        this.ndExitFrame.active = false;\r\n    },\r\n});"]}
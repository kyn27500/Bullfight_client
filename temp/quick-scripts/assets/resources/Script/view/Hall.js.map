{"version":3,"sources":["Hall.js"],"names":["self","serverConnect","require","requestHandler","onfire","events","GameData","cc","Class","extends","Component","properties","labelNotice","Label","labelName","labelPlayerId","labelScore","btnRoom_niuniu","Button","btnJoinRoom","onLoad","connect","on","OPEN","onServerConnectOpen","ERROR","onServerConnectError","start","data","name","playerId","notice","score","setUserInfo","onDestroy","obj","console","log","JSON","stringify","un","hall","S2C_LOGIN","data1","data2","userInfo","loginId","sendRequest","C2S_LOGIN","joinRoom","onResourceLoaded","errorMessage","loadedResource","Prefab","gamePrefab","instantiate","node","addChild","loader","loadRes","string","uid"],"mappings":"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","file":"Hall.js","sourceRoot":"../../../../../../assets/resources/Script/view","sourcesContent":["\nvar self;\nvar serverConnect = require(\"ServerConnect\");\nvar requestHandler = require(\"RequestHandler\");\nvar onfire = require(\"onfire\");\nvar events = require(\"CustomEvents\");\nvar GameData = require(\"GameData\")\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        labelNotice: cc.Label,\n        labelName: cc.Label,\n        labelPlayerId: cc.Label,\n        labelScore: cc.Label,\n\n        btnRoom_niuniu: cc.Button,\n        btnJoinRoom: cc.Button,\n    },\n\n    // use this for initialization\n    onLoad: function () {\n        self = this;\n\n        serverConnect.connect(true);\n        onfire.on(events.onfire.OPEN, this.onServerConnectOpen);\n        onfire.on(events.onfire.ERROR, this.onServerConnectError);\n    },\n\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n    start() {\n\n        var data = {\n            name: \"唱山歌\",\n            playerId: 123,\n            notice: \"我是公告！\",\n            score: 23422,\n        }\n        self.setUserInfo(data)\n    },\n\n    onDestroy() {\n\n    },\n\n    onServerConnectError: function(obj) {\n        console.log(JSON.stringify(obj));\n    },\n\n    onServerConnectOpen: function() {\n        console.log(\"server connected\");\n        onfire.un(events.onfire.OPEN);\n\n        onfire.on(events.hall.S2C_LOGIN, function(data1, data2) {\n            console.log(\"s_game_login=====\", data1);\n            GameData.setUserInfo(data1.userInfo);\n            self.setUserInfo(data1.userInfo)\n            onfire.un(events.hall.S2C_LOGIN);\n        });\n\n        var data = {\n            loginId:123\n        };\n        requestHandler.sendRequest(events.hall.C2S_LOGIN, data);\n    },\n\n    joinRoom() {\n        var onResourceLoaded = function(errorMessage, loadedResource) {\n            //检查失败原因\n            if (errorMessage) {\n                cc.log('加载失败, 原因:' + errorMessage);\n                return;\n            }\n            if (!(loadedResource instanceof cc.Prefab)) {\n                cc.log('类型不对！');\n                return;\n            } //這個是型別的檢查\n\n            //接著，我們就可以進行實例化了\n            var gamePrefab = cc.instantiate(loadedResource);\n            self.node.addChild(gamePrefab);\n            \n        };\n        //這邊才是真的使用cc.loader進行載入，並且呼叫我們上面寫的方法\n        cc.loader.loadRes(\"Prefab/join_room\", onResourceLoaded);\n    },\n\n    setUserInfo(data) {\n        self.labelName.string = data.name;\n        self.labelPlayerId.string = data.uid;\n        // self.labelNotice.string = data.notice;\n        self.labelScore.string = data.score;\n    }\n});\n"]}